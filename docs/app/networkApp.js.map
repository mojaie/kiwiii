{"version":3,"file":"networkApp.js","sources":["../../src/common/client.js","../../src/common/misc.js","../../src/common/legacySchema.js","../../src/common/idb.js","../../src/component/badge.js","../../src/component/button.js","../../src/component/modal.js","../../src/common/scale.js","../../src/component/shape.js","../../src/component/legend.js","../../src/component/transform.js","../../src/component/formBox.js","../../src/dialog/community.js","../../src/dialog/rename.js","../../src/common/fetcher.js","../../src/common/mapper.js","../../src/common/collection.js","../../src/common/transform.js","../../src/network/state.js","../../src/network/communityDetection.js","../../src/component/formListBox.js","../../src/component/formRangeBox.js","../../src/component/dropdown.js","../../src/component/formBoxGroup.js","../../src/component/controlBox.js","../../src/network/explorativeNetwork.js","../../src/network/component.js","../../src/network/interaction.js","../../src/network/force.js","../../src/network/controlBox.js","../../src/networkApp.js"],"sourcesContent":["\n/** @module common/client */\n\nimport _ from 'lodash';\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\nfunction compatibility() {\n  if (!window.indexedDB) {\n    return 'Client compatibility error: IndexedDB not supported';\n  }\n  try {\n    () => {};\n  } catch (err) {\n    return 'Client compatibility error: Arrow function not supported';\n  }\n  try {\n    FormData;\n  } catch (err) {\n    return 'Client compatibility error: FormData not supported';\n  }\n  try {\n    fetch;\n  } catch (err) {\n    return 'Client compatibility error: fetch API not supported';\n  }\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    if (!isDebugBuild) {  // Grobal isDebugBuild (see rollup.js)\n      window.addEventListener('load', () => {\n        navigator.serviceWorker.register('../sw.js');  // TODO: root path option\n      });\n    } else {\n      console.info('Service worker is disabled for debugging');\n    }\n  } else {\n    console.info('Service worker is not supported');\n  }\n}\n\n\nfunction registerCtrlCommand(key, callback) {\n  document.addEventListener('keydown', event => {\n    if (event.ctrlKey && event.key === key) {\n      callback();\n    }\n  });\n}\n\n\nexport default {\n  URLQuery, compatibility, registerServiceWorker, registerCtrlCommand\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\n// TODO: re-define\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  if (['text_field', 'checkbox', 'html'].includes(fmt)) return 'html';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  let specs = {};\n  if (!json.hasOwnProperty('views')) {\n    const now = new Date();\n    const isNW = json.hasOwnProperty('edges');\n    const data = isNW ? convertNetwork(json) : convertTable(json);\n    const nodes = isNW ? data.nodes : data;\n    specs = {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n      name: data.edges.name,\n      views: [],\n      dataset: []\n    };\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: nodes.id,\n      name: nodes.name,\n      contents: [{\n        $schema: nodes.$schema,\n        workflowID: nodes.reference.workflow,\n        name: nodes.name,\n        fields: nodes.fields,\n        records: nodes.records,\n        created: nodes.created,\n        status: nodes.status,\n        query: nodes.query,\n        execTime: nodes.execTime,\n        progress: nodes.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: nodes.id,\n      name: nodes.name,\n      viewType: \"datagrid\",\n      rows: nodes.id,\n      fields: nodes.fields,\n      sortOrder: null,\n      filterText: null,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n    if (isNW) {\n      specs.dataset.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: data.edges.id,\n        name: data.edges.name,\n        contents: [{\n          $schema: data.edges.$schema,\n          workflowID: data.edges.reference.workflow,\n          name: data.edges.name,\n          fields: data.edges.fields,\n          records: data.edges.records,\n          created: data.edges.created,\n          status: data.edges.status,\n          query: data.edges.query,\n          execTime: data.edges.execTime,\n          progress: data.edges.progress\n        }]\n      });\n      specs.views.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n        viewID: data.edges.id,\n        name: data.edges.name,\n        viewType: \"network\",\n        nodes: nodes.id,\n        edges: data.edges.id,\n        nodeColor: data.edges.snapshot.nodeColor,\n        nodeSize: data.edges.snapshot.nodeSize,\n        nodeLabel: data.edges.snapshot.nodeLabel,\n        nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n        edgeWidth: data.edges.snapshot.edgeWidth,\n        edgeLabel: data.edges.snapshot.edgeLabel,\n        networkThreshold: data.edges.snapshot.networkThreshold,\n        networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n        fieldTransform: data.edges.snapshot.fieldTransform,\n        coords: data.edges.snapshot.coords,\n        checkpoints: [{\n          type: 'convert',\n          date: now.toString(),\n          description: 'converted from legacy format'\n        }]\n      });\n    }\n    specs.views.filter(e => e.viewType === 'network')\n      .forEach(view => {\n        view.minConnThld = view.networkThresholdCutoff;\n        view.currentConnThld = view.networkThreshold;\n        if (view.hasOwnProperty('nodeLabel')) {\n          view.nodeLabel.field = view.nodeLabel.text;\n        }\n        if (view.hasOwnProperty('edgeLabel')) {\n          view.edgeLabel.field = 'weight';\n        }\n        if (view.hasOwnProperty('edgeWidth')) {\n          view.edgeWidth.field = 'weight';\n        }\n      });\n  } else {\n    specs = json;\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      if (!view.nodeColor.field) { view.nodeColor.field = 'index' ;}\n      if (!view.nodeSize.field) { view.nodeSize.field = 'index' ;}\n      if (!view.nodeLabel.field) { view.nodeLabel.field = 'index' ;}\n      if (!view.nodeLabelColor.field) { view.nodeLabelColor.field = 'index' ;}\n      if (!view.edgeColor) {\n        view.edgeColor = {\n          field: 'weight', color: 'monogray',\n          scale: 'linear', domain: [0, 1],\n          range: ['#999999', '#999999'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeColor.field) { view.edgeColor.field = 'weight' ;}\n      if (!view.edgeWidth.field) { view.edgeWidth.field = 'weight' ;}\n      if (!view.edgeLabel.field) { view.edgeLabel.field = 'weight' ;}\n      if (!view.edgeLabelColor) {\n        view.edgeLabelColor = {\n          field: 'weight', color: 'monoblack',\n          scale: 'linear', domain: [1, 1],\n          range: ['#333333', '#333333'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeLabelColor.field) { view.edgeLabelColor.field = 'weight' ;}\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n\n// Increment versions if IDB schema has updated.\nconst pkgStoreVersion = 2;\nconst assetStoreVersion = 1;\n\n\nfunction connect(name, version, createObj) {\n  return new Promise((resolve, reject) => {\n    const request = window.indexedDB.open(name, version);\n    request.onsuccess = function () {\n      resolve(this.result);\n    };\n    request.onerror = event => reject(event);\n    request.onupgradeneeded = event => {\n      createObj(event.currentTarget.result);\n    };\n  });\n}\n\n\nconst instance = {\n  pkgs: connect(\"Packages\", pkgStoreVersion, db => {\n    db.createObjectStore(\"Packages\", {keyPath: 'id'});\n  }),\n  assets: connect(\"Assets\", assetStoreVersion, db => {\n    db.createObjectStore(\"Assets\", {keyPath: 'key'});\n  })\n};\n\n\n/**\n * Clear database\n * @param {string} dbid - database ID\n */\nfunction clear(dbid) {\n  return new Promise((resolve, reject) => {\n    return instance[dbid].then(db => {\n      const req = db.transaction(db.name, 'readwrite')\n          .objectStore(db.name).clear();\n        req.onsuccess = () => resolve();\n        req.onerror = event => reject(event);\n    });\n  });\n}\n\n\n/**\n * Delete all data in the local storage\n */\nfunction clearAll() {\n  return Promise.all([clear('pkgs'), clear('assets')]);\n}\n\n\n/**\n * Returns all packages\n * @return {Promise} Promise of list of packages\n */\nfunction getAllItems() {\n  return new Promise(resolve => {\n    const res = [];\n    return instance.pkgs.then(db => {\n      db.transaction(db.name)\n        .objectStore(db.name).openCursor()\n        .onsuccess = event => {\n          const cursor = event.target.result;\n          if (cursor) {\n            res.push(cursor.value);\n            cursor.continue();\n          } else {\n            resolve(res);\n          }\n        };\n    });\n  });\n}\n\n\n/**\n * Get packages by instance ID\n * @param {string} id - Package instance ID\n * @return {array} data store object\n */\nfunction getItem(id) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const req = db.transaction(db.name)\n        .objectStore(db.name).get(id);\n      req.onsuccess = event => resolve(event.target.result);\n      req.onerror = event => reject(event);\n    });\n  });\n}\n\n\n/**\n * Put data object in the store\n * @param {string} value - value to store\n */\nfunction putItem(value) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const obj = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name);\n      const req = obj.put(value);\n      req.onerror = event => reject(event);\n      req.onsuccess = () => resolve();\n    });\n  });\n}\n\n\n/**\n * Update package in the store\n * @param {string} id - Package instance ID\n * @param {function} updater - update function\n */\nfunction updateItem(id, updater) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const obj = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name);\n      const req = obj.get(id);\n      req.onerror = event => reject(event);\n      req.onsuccess = event => {\n        const res = event.target.result;\n        updater(res);\n        const upd = obj.put(res);\n        upd.onsuccess = () => resolve();\n        upd.onerror = event => reject(event);\n      };\n    });\n  });\n}\n\n\n/**\n * Delete a package\n * @param {string} id - Package instance ID\n */\nfunction deleteItem(id) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const req = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name).delete(id);\n      req.onerror = event => reject(event);\n      req.onsuccess = () => resolve();\n    });\n  });\n}\n\n\n/**\n * Returns a view\n * @param {string} id - Package instance ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(id, viewID) {\n  return getItem(id)\n    .then(pkg => pkg.views.find(e => e.viewID === viewID));\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} id - Package instance ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(id, viewID, viewObj) {\n  return updateItem(id, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} id - Package instance ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(id, viewID, viewObj) {\n  return updateItem(id, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} id - Package instance ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(id, viewID) {\n  return updateItem(id, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns all collections in the store\n * @return {array} Collection objects\n */\nfunction getAllCollections() {\n  return getAllItems()\n    .then(items => _.flatten(\n      items.map(item => {\n        return item.dataset.map(coll => {\n          coll.instance = item.id;\n          return coll;\n        });\n      })\n    ));\n}\n\n\n/**\n * Returns a collection\n * @param {string} id - Package instance ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(id, collID) {\n  return getItem(id)\n    .then(pkg => pkg.dataset.find(e => e.collectionID === collID));\n}\n\n\nfunction addCollection(id, collID, collObj) {\n  return updateItem(id, item => {\n    item.dataset.push(collObj);\n  });\n}\n\n/**\n * Update collection\n * @param {string} id - Package instance ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(id, collID, collObj) {\n  return updateItem(id, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - id if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  data = legacy.convertPackage(data);\n\n  const now = new Date();\n  data.id = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return putItem(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const instance = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    id: instance,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: response.name,\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return putItem(data)\n    .then(() => ({instance: instance, viewID:viewID}));\n}\n\n\nfunction addDatagrid(instance, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  return updateItem(instance, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: viewID,\n      name: response.name,\n      viewType: \"datagrid\",\n      rows: collectionID,\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: collectionID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\nfunction new384Tiles(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const instance = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    id: instance,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n        viewID: viewID,\n        name: `${response.name}_tiles`,\n        viewType: 'tile',\n        items: collectionID,\n        rowCount: 16,\n        columnCount: 24\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return putItem(data)\n    .then(() => ({instance: instance, viewID:viewID}));\n}\n\n\nfunction add384Tiles(instance, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  return updateItem(instance, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n      viewID: viewID,\n      name: `${response.name}_tiles`,\n      viewType: 'tile',\n      items: collectionID,\n      rowCount: 16,\n      columnCount: 24,\n      chunksPerRow: 10\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: collectionID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\n/**\n * Store new network view\n * @param {string} instance - Package instance ID\n * @param {string} nodesID - ID of nodes collection\n * @param {string} nodesName - Name of nodes collection\n * @param {object} response - Response object\n */\nfunction newNetwork(instance, nodesID, nodesName, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const edgesID = response.workflowID.slice(0, 8);\n  return updateItem(instance, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: viewID,\n      name: `${nodesName}_${response.name}`,\n      viewType: 'network',\n      nodes: nodesID,\n      edges: edgesID,\n      minConnThld: response.query.params.threshold\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: edgesID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\n/**\n * Get asset by a key\n * @param {string} key - key\n * @return {array} asset object (if not found, resolve with undefined)\n */\nfunction getAsset(key) {\n  return new Promise((resolve, reject) => {\n    return instance.assets.then(db => {\n      const req = db.transaction(db.name)\n        .objectStore(db.name).get(key);\n      req.onsuccess = event => {\n        const undef = event.target.result === undefined;\n        const value = undef ? undefined : event.target.result.value;\n        resolve(value);\n      };\n      req.onerror = event => reject(event);\n    });\n  });\n}\n\n/**\n * Put asset object with a key\n * @param {string} key - key\n * @param {string} content - asset to store\n */\nfunction putAsset(key, content) {\n  return new Promise((resolve, reject) => {\n    return instance.assets.then(db => {\n      const obj = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name);\n      const req = obj.put({key: key, value: content});\n      req.onerror = event => reject(event);\n      req.onsuccess = () => resolve();\n    });\n  });\n}\n\n\nexport default {\n  clear, clearAll, getAllItems, getItem, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getAllCollections, getCollection, addCollection, updateCollection,\n  importItem, newDatagrid, addDatagrid, add384Tiles, newNetwork,\n  getAsset, putAsset\n};\n","\n/** @module component/badge */\n\nimport d3 from 'd3';\n\nconst assetBaseURL = '../assets/';\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction badge(selection) {\n  selection.classed('badge', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true);\n}\n\n\nfunction updateBadge(selection, text, type, icon) {\n  selection.classed(`badge-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction notify(selection) {\n  selection\n    .style('opacity', 0)\n    .style('display', 'inline')\n    .transition()\n      .duration(500)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 1.0)\n    .transition()\n      .delay(3000)\n      .duration(1000)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 0)\n      .on('end', function () {\n        selection.style('display', 'none');\n      });\n}\n\n\nfunction loadingCircle(selection) {\n  selection\n      .style('display', 'none')\n    .append('img')\n      .attr('src', `${assetBaseURL}loading1.gif`)\n      .style('width', '2rem')\n      .style('height', '2rem');\n}\n\n\nfunction alert(selection) {\n  selection.classed('alert', true)\n      .classed('px-1', true)\n      .classed('py-0', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true)\n      .style('font-size', '75%');\n}\n\n\nfunction updateAlert(selection, text, type, icon) {\n  selection.classed(`alert-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction invalidFeedback(selection) {\n  selection.classed('invalid-feedback', true)\n      .style('display', 'none');\n  selection.append('img')\n      .classed('icon', true)\n      .attr('src', `${iconBaseURL}caution-salmon.svg`)\n      .style('width', '1rem')\n      .style('height', '1rem');\n  selection.append('span')\n      .classed('invalid-msg', true);\n}\n\nfunction updateInvalidMessage(selection, msg) {\n  selection.select('.invalid-msg')\n      .text(msg);\n}\n\n\nexport default {\n  badge, updateBadge, notify, loadingCircle,\n  alert, updateAlert, invalidFeedback, updateInvalidMessage\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction buttonBox(selection, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  iconBaseURL, buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('OK')\n      .on('click', () => {\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction updateConfirmDialog(selection, message) {\n  selection.select('.message').text(message);\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Submit')\n      .on('click', () => {\n        // Dismiss before submit\n        // Submit event can update the modal itself\n        // (ex. disable submit button before onSubmit call has completed)\n        $(`#${id}`).modal('hide');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, updateConfirmDialog, submitDialog\n};\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst colorScales = [\n  {key: 'monoblack', type: 'monocolor', colors: ['#333333'], unknown: '#333333'},\n  {key: 'monogray', type: 'monocolor', colors: ['#cccccc'], unknown: '#cccccc'},\n  {key: 'nodeDefault', type: 'monocolor', colors: ['#7fffd4'], unknown: '#7fffd4'},\n  {key: 'aquamarine', type: 'bicolor',\n   colors: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', type: 'bicolor',\n   colors: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', type: 'bicolor',\n   colors: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', type: 'bicolor',\n   colors: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', type: 'tricolor',\n   colors: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', type: 'tricolor',\n   colors: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'},\n  {key: 'category10', type: 'categorical',\n   colors: ['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462',\n    '#b3de69','#fccde5','#bc80bd','#ccebc5'], unknown: '#f0f0f0'},\n  {key: 'cbsafe', type: 'categorical',\n   colors: ['#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5',\n   '#80cdc1','#35978f','#01665e','#003c30'], unknown: '#f0f0f0'},\n  {key: 'category20', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'},\n  {key: 'custom', type: 'custom', colors: ['#ffffff'], text: 'custom'}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear},\n  {key: 'log', name: 'Log', func: d3.scaleLog},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal}\n];\n\n\nfunction scaleFunction(state) {\n  const cscale = colorScales.find(e => e.key === state.color);\n  let range;\n  let unknown;\n  if (cscale && cscale.key !== 'custom') {\n      range = cscale.colors;\n      unknown = cscale.unknown;\n  } else {\n    range = state.range;\n    unknown = state.unknown;\n  }\n  let domain = null;\n  if (range.length === 3) {\n    const mid = (parseFloat(state.domain[0]) + parseFloat(state.domain[1])) / 2;\n    domain = [state.domain[0], mid, state.domain[1]];\n  } else {\n    domain = state.domain;\n  }\n  // Build\n  let scaleFunc = types.find(e => e.key === state.scale).func();\n  scaleFunc = scaleFunc.domain(domain);\n  scaleFunc = scaleFunc.range(range);\n  if (['linear', 'log'].includes(state.scale)) {\n    scaleFunc = scaleFunc.clamp(true);\n  }\n\n  return d => {\n    // Sanitize\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return unknown;  // invalid values\n    }\n    if (['linear', 'log'].includes(state.scale) && parseFloat(d) != d) {\n      return unknown;  // texts\n    }\n    if (state.scale === 'log' && d <= 0) {\n      return unknown;  // negative values in log scale\n    }\n    // Apply function\n    const result = scaleFunc(d);\n    if (result === undefined) {\n      return unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nfunction isD3Format(notation) {\n  try {\n    d3.format(notation);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}\n\n\nexport default {\n  colorScales, types, scaleFunction, isD3Format\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 10)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/legend */\n\nimport {default as scale} from '../common/scale.js';\n\nimport {default as shape} from './shape.js';\n\n\nfunction colorBarLegend(selection) {\n  selection.append('rect')\n      .classed('bg', true)\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 120).attr('height', 50)\n      .attr('fill', 'white')\n      .attr('opacity', 0.9);\n  selection.append('text')\n      .classed('title', true)\n      .attr('text-anchor', 'middle')\n      .attr('x', 60).attr('y', 15)\n      .style('font-size', 12);\n  selection.append('g')\n      .classed('colorbar', true)\n      .attr('transform', 'translate(10, 20)');\n  const domains = selection.append('g')\n      .classed('label', true)\n      .attr('transform', 'translate(10, 40)')\n      .style('font-size', 12);\n  domains.append('text')\n      .classed('min', true)\n      .attr('text-anchor', 'start')\n      .attr('x', 0).attr('y', 0);\n  domains.append('text')\n      .classed('max', true)\n      .attr('text-anchor', 'end')\n      .attr('x', 100).attr('y', 0);\n}\n\n\nfunction updateColorBarLegend(selection, colorState) {\n  const field = scale.colorScales.find(e => e.key === colorState.color);\n  const colorBar = shape.colorBar[field.type];\n  const range = field.key === 'custom' ? colorState.range : field.colors;\n  selection.select('.title').text(colorState.field);\n  selection.select('.colorbar').selectAll('g,defs').remove();\n  selection.select('.colorbar').call(colorBar, range);\n  selection.select('.min')\n    .attr('visibility',\n          ['bicolor', 'tricolor'].includes(field.type) ? 'inherit' : 'hidden')\n    .text(colorState.domain[0]);\n  selection.select('.max')\n    .attr('visibility',\n          ['bicolor', 'tricolor'].includes(field.type) ? 'inherit' : 'hidden')\n    .text(colorState.domain[1]);\n}\n\n\n/**\n * Legend group component\n * @param {d3.selection} selection - selection of group container (svg:g)\n */\nfunction updateLegendGroup(selection, viewBox, orient) {\n  const widthFactor = 0.2;\n  const scaleF = viewBox.right * widthFactor / 120;\n  const o = orient.split('-');\n  const viewW = viewBox.right;\n  const viewH = viewBox.bottom;\n  const legW = viewW * widthFactor;\n  const legH = legW * 50 / 120;\n  const posX = {left: legW / 10, right: viewW - legW - (legW / 10)}[o[1]];\n  const posY = {top: legH / 10, bottom: viewH - legH - (legH / 10)}[o[0]];\n  selection.attr('transform',\n                 `translate(${posX}, ${posY}) scale(${scaleF})`);\n}\n\n\nexport default {\n  colorBarLegend, updateColorBarLegend, updateLegendGroup\n};\n","\n/** @module component/transform */\n\nimport {default as legend} from '../component/legend.js';\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  const width = area.offsetWidth;\n  const height = area.offsetHeight;\n  selection.select('.view')\n      .attr('viewBox', `0 0 ${width} ${height}`)\n    .select('.boundary')\n      .attr('width', width)\n      .attr('height', height);\n  state.setViewBox(width, height);\n  state.resizeNotifier();\n}\n\n\nfunction viewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.view').remove(); // Clean up\n  selection.append('svg')\n    .classed('view', true);\n  selection.call(resize, state);\n}\n\n\nfunction view(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.selectAll('g, rect').remove();\n\n  // Boundary\n  selection.append('rect')\n      .classed('boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  // Field\n  selection.append('g')\n      .classed('field', true)\n      .style('opacity', 1e-6)\n    .transition()\n      .duration(1000)\n      .style('opacity', 1);\n}\n\n\nexport default {\n  transform, resize, viewFrame, view\n};\n","\n/** @module component/formBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\n\n\nfunction updateFormValue(selection, value) {\n  selection.select('.form-control').property('value', value);\n  selection.call(setValidity, true);  // Clear validity state\n}\n\n\nfunction formValue(selection) {\n  return selection.select('.form-control').property('value');\n}\n\n\nfunction formValid(selection) {\n  return selection.select('.form-control').node().checkValidity();\n}\n\n\nfunction setValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : '#ffcccc');\n}\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .attr('readonly', 'readonly');\n}\n\nfunction updateReadonlyValue(selection, value) {\n  selection.select('.form-control-plaintext').property('value', value);\n}\n\nfunction readonlyValue(selection) {\n  return selection.select('.form-control-plaintext').property('value');\n}\n\n\nfunction textareaBox(selection, label, rows, placeholder) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .on('input', function () {\n        const valid = textareaValid(selection);\n        selection.call(setValidity, valid);\n      });\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n')\n    .map(e => e.replace(/^\\s+|\\s+$/g, ''))  // strip spaces\n    .filter(e => e.length > 0);\n  return [];\n}\n\nfunction textareaValid(selection) {\n  return /\\s*?\\w\\s*?/.test(formValue(selection));\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction updateNumberRange(selection, min, max, step) {\n  selection.select('.form-control')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step)\n      .dispatch('input', {bubbles: true});\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept)\n      .on('change', function () {\n        const valid = fileInputValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const label = selection.select('label').text();\n  const accept = selection.select('input').attr('accept');\n  selection.selectAll('*').remove();\n  selection.call(fileInputBox, label, accept);\n}\n\nfunction fileInputValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\nfunction fileInputValid(selection) {\n  // TODO: attribute 'require' does not work with input type=file\n  return selection.select('input').property('files').length > 0;\n}\n\n\nexport default {\n  updateFormValue, formValue, formValid, setValidity,\n  textBox, readonlyBox, updateReadonlyValue, readonlyValue,\n  textareaBox, textareaBoxLines, textareaValid,\n  numberBox, updateNumberRange,\n  checkBox, updateCheckBox, checkBoxValue,\n  colorBox,\n  fileInputBox, clearFileInput, fileInputValue, fileInputValid\n};\n","\n/** @module dialog/community */\n\nimport d3 from 'd3';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'community-dialog';\nconst title = 'Comunity detection';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-painting');\n}\n\n\nfunction body(selection) {\n  const mbody = selection.call(modal.submitDialog, id, title)\n      .select('.modal-body');\n\n  // Name\n  mbody.append('div')\n      .classed('name', true)\n      .call(box.textBox, 'New name')\n    .select('.form-control')\n      .attr('required', 'required');\n\n  // Assign null to isolated nodes\n  mbody.append('div')\n      .classed('nulliso', true)\n      .call(box.checkBox, 'Assign null to isolated nodes');\n}\n\n\nfunction updateBody(selection, fields) {\n  selection.select('.name')\n      .call(box.formValue, null)\n      .on('input', function() {\n        const value = box.formValue(d3.select(this));\n        const noDup = !fields.map(e => e.key).includes(value);\n        if (!noDup) box.setValidity(d3.select(this), false);\n        const invmsg = noDup ? 'Please provide valid field name'\n          : `Key '${value}' already exsists`;\n        d3.select(this).call(badge.updateInvalidMessage, invmsg);\n        const valid = noDup && box.formValid(d3.select(this));\n        selection.select('.submit').property('disabled', !valid);\n      });\n\n  selection.select('.nulliso')\n      .call(box.updateCheckBox, true);\n  selection.select('.submit').property('disabled', true);\n}\n\n\nfunction value(selection) {\n  return {\n    name: box.formValue(selection.select('.name')),\n    nulliso: box.checkBoxValue(selection.select('.nulliso'))\n  };\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module dialog/rename */\n\nimport d3 from 'd3';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-edittext');\n}\n\n\nfunction body(selection) {\n  const renameBox = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'New name');\n  renameBox.select('.form-control')\n      .attr('required', 'required');\n  renameBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please provide a valid name');\n}\n\n\nfunction updateBody(selection, name) {\n  selection.select('.rename')\n      .call(box.updateFormValue, name)\n      .on('input', function () {\n        const valid = box.formValid(d3.select(this));\n        selection.select('.submit').property('disabled', !valid);\n      })\n      .dispatch('input');\n}\n\n\nfunction value(selection) {\n  return box.formValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nfunction batchRequest(reqs, interval) {\n  const ress = reqs.map((req, i) => {\n    return new Promise(resolve => {\n      setTimeout(() => resolve(req()), i * interval * 1000);\n    });\n  });\n  return Promise.all(ress);\n}\n\n\nfunction sequentialBatchRequest(reqs, interval) {\n  const ress = [];\n  const batch = reqs.reduce((a, b) => {\n    return a\n      .then(res => {\n        if (res) ress.push(res);\n        return new Promise(resolve => {\n          setTimeout(() => resolve(b()), interval * 1000);\n        });\n      });\n  }, Promise.resolve());\n  return batch.then(() => ress);\n}\n\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus, batchRequest\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.instance = coll.instance || null;\n    this.name = coll.name || null;\n    if (coll.records) {\n      this.contents = [coll];\n      this.fields = [];\n    } else {\n      this.contents = coll.contents;\n      this.fields = coll.fields || [];\n    }\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Apply function to the original data records\n   * new fields should be manually added by Collection.addField\n   * @param {function} func - function to be applied\n   */\n  apply(func) {\n    this.contents.forEach(content => {\n      content.records.forEach(rcd => {\n        func(rcd);\n      });\n    });\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.instance, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.instance, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/transform */\n\nimport d3 from 'd3';\n\n\nexport default class TransformState {\n  constructor(width, height, transform) {\n    this.fieldWidth = width;\n    this.fieldHeight = height;\n\n    this.viewBox = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.focusArea = {};\n    this.focusAreaMargin = 50;\n\n    this.boundary = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.transform = transform || {x: 0, y: 0, k: 1};\n    this.prevTransform = {\n      x: this.transform.x,\n      y: this.transform.y,\n      k: this.transform.k\n    };\n\n    this.resizeNotifier = () => {};\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = this.focusAreaMargin;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  fitTransform() {\n    const vh = this.viewBox.bottom;\n    const vw = this.viewBox.right;\n    const vr = vw / vh;\n    const bh = this.boundary.bottom - this.boundary.top;\n    const bw = this.boundary.right - this.boundary.left;\n    const br = bw / bh;\n    const isPortrait = vr >= br;\n    const tk = isPortrait ? vh / bh : vw / bw;\n    const adjustH = isPortrait ? (vw - bw * tk) / 2 : 0;\n    const adjustV = isPortrait ? 0 : (vh - bh * tk) / 2;\n    const tx = -(this.boundary.left) * tk + adjustH;\n    const ty = -(this.boundary.top) * tk + adjustV;\n    this.setTransform(tx, ty, tk);\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module network/state */\n\nimport Collection from '../common/collection.js';\nimport TransformState from  '../common/transform.js';\nimport {default as idb} from '../common/idb.js';\n\n\nexport default class NetworkState extends TransformState {\n  constructor(view, nodes, edges) {\n    super(1200, 1200, view.fieldTransform);\n\n    /* Settings */\n\n    // Focused view mode (num of nodes displayed are less than the thld)\n    // Show node contents\n    // Disable smooth transition\n    this.focusedViewThreshold = 100;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n    // Overlook view mode (num of nodes displayed are less than the thld)\n    // Hide edges\n    this.overlookViewThreshold = 500;\n    this.enableOverlookView = true;\n    this.overlookView = false;\n\n    // Legend orientation\n    this.legendOrient = 'top-left';\n\n    /* Attributes */\n\n    this.viewID = view.viewID || null;\n    this.instance = view.instance || null;\n    this.name = view.name;\n\n    this.nodes = new Collection(nodes);\n    this.edges = new Collection(edges);\n\n    /* Appearance */\n    const defaultNodeField = 'index';\n    const defaultEdgeField = 'weight';\n\n    this.nodeColor = {\n      field: defaultNodeField, color: 'nodeDefault',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4',\n      legend: true\n    };\n    Object.assign(this.nodeColor, view.nodeColor || {});\n\n    this.nodeSize = {\n      field: defaultNodeField, scale: 'linear', domain: [1, 1],\n      range: [40, 40], unknown: 40, legend: false\n    };\n    Object.assign(this.nodeSize, view.nodeSize || {});\n\n    this.nodeLabel = {\n      field: defaultNodeField, size: 20, visible: false\n    };\n    Object.assign(this.nodeLabel, view.nodeLabel || {});\n\n    this.nodeLabelColor = {\n      field: defaultNodeField, color: 'monoblack',\n      scale: 'linear', domain: [1, 1],\n      range: ['#333333', '#333333'], unknown: '#cccccc',\n      legend: false\n    };\n    Object.assign(this.nodeLabelColor, view.nodeLabelColor || {});\n\n    this.edgeColor = {\n      field: defaultEdgeField, color: 'monogray',\n      scale: 'linear', domain: [0, 1],\n      range: ['#999999', '#999999'], unknown: '#cccccc'\n    };\n    Object.assign(this.edgeColor, view.edgeColor || {});\n\n    this.edgeWidth = {\n      field: defaultEdgeField, scale: 'linear', domain: [0.5, 1],\n      range: [10, 10], unknown: 1\n    };\n    Object.assign(this.edgeWidth, view.edgeWidth || {});\n\n    this.edgeLabel = {\n      field: defaultEdgeField, size: 12, visible: false\n    };\n    Object.assign(this.edgeLabel, view.edgeLabel || {});\n\n    this.edgeLabelColor = {\n      field: defaultEdgeField, color: 'monoblack',\n      scale: 'linear', domain: [1, 1],\n      range: ['#333333', '#333333'], unknown: '#cccccc'\n    };\n    Object.assign(this.edgeLabelColor, view.edgeLabelColor || {});\n\n    // Connection threshold\n    this.connThldField = view.connThldField || defaultEdgeField;\n    this.minConnThld = view.minConnThld;\n    this.currentConnThld = view.currentConnThld || view.minConnThld;\n\n    // Force\n    this.coords = view.coords;\n    this.forceActive = !this.coords;\n    this.forceType = view.forceType || 'aggregate';\n\n    // Event listeners\n    this.zoomListener = null;\n    this.dragListener = null;\n\n    // Event notifiers\n    this.updateAllNotifier = null;\n    this.updateComponentNotifier = null;\n    this.updateNodeNotifier = null;\n    this.updateEdgeNotifier = null;\n    this.updateNodeAttrNotifier = null;\n    this.updateEdgeAttrNotifier = null;\n    this.updateLegendNotifier = null;\n    this.updateControlBoxNotifier = () => {};\n    this.updateInteractionNotifier = () => {};\n    this.fitNotifier = () => {};\n    this.setForceNotifier = () => {};\n    this.stickNotifier = () => {};\n    this.relaxNotifier = () => {};\n    this.restartNotifier = () => {};\n    this.tickCallback = () => {};\n\n    // Working copies\n    // D3.force does some destructive operations\n    this.ns = null;\n    this.es = null;\n  }\n\n  updateWorkingCopy() {\n    if (this.ns) {\n      this.coords = this.ns.map(e => ({x: e.x, y: e.y}));\n    }\n    this.ns = JSON.parse(JSON.stringify(this.nodes.records()));\n    this.ns.forEach(n => { n.adjacency = []; });\n    this.es = JSON.parse(JSON.stringify(this.edges.records()));\n    this.es.forEach((e, i) => {\n      e.num = i;  // e.index will be overwritten by d3-force\n      this.ns[e.source].adjacency.push([e.target, i]);\n      this.ns[e.target].adjacency.push([e.source, i]);\n    });\n    if (this.coords) {\n      this.setAllCoords(this.coords);\n    }\n  }\n\n  setBoundary() {\n    const xs = this.ns.map(e => e.x);\n    const ys = this.ns.map(e => e.y);\n    this.boundary.top = Math.min.apply(null, ys);\n    this.boundary.left = Math.min.apply(null, xs);\n    this.boundary.bottom = Math.max.apply(null, ys);\n    this.boundary.right = Math.max.apply(null, xs);\n    // this.showBoundary(); // debug\n  }\n\n  setAllCoords(coordsList) {\n    this.ns.forEach(n => {\n      n.x = coordsList[n.index].x;\n      n.y = coordsList[n.index].y;\n      // this.es can be changed by forceSimulation so use adjacency\n      n.adjacency.forEach(e => {\n        const nbr = e[0];\n        const edge = e[1];\n        if (n.index < nbr) {\n          this.es[edge].sx = coordsList[n.index].x;\n          this.es[edge].sy = coordsList[n.index].y;\n        } else {\n          this.es[edge].tx = coordsList[n.index].x;\n          this.es[edge].ty = coordsList[n.index].y;\n        }\n      });\n    });\n    this.setBoundary();\n  }\n\n  setCoords(n, x, y) {\n    this.ns[n].x = x;\n    this.ns[n].y = y;\n    this.ns[n].adjacency.forEach(e => {\n      const nbr = e[0];\n      const edge = e[1];\n      if (n < nbr) {\n        this.es[edge].sx = x;\n        this.es[edge].sy = y;\n      } else {\n        this.es[edge].tx = x;\n        this.es[edge].ty = y;\n      }\n    });\n    this.setBoundary();\n  }\n\n  nodesToRender() {\n    return this.ns.filter(\n      e => e.y > this.focusArea.top && e.x > this.focusArea.left\n        && e.y < this.focusArea.bottom && e.x < this.focusArea.right\n    );\n  }\n\n  currentEdges() {\n    return this.es.filter(e => e[this.connThldField] >= this.currentConnThld);\n  }\n\n  edgesToRender() {\n    return this.currentEdges().filter(\n      e => this.focusArea.top < Math.max(e.sy, e.ty)\n        && this.focusArea.left < Math.max(e.sx, e.tx)\n        && this.focusArea.bottom > Math.min(e.sy, e.ty)\n        && this.focusArea.right > Math.min(e.sx, e.tx)\n    );\n  }\n\n  save() {\n    this.coords = this.ns.map(n => ({x: n.x, y: n.y}));\n    return idb.updateItem(this.instance, item => {\n      const ni = item.dataset\n        .findIndex(e => e.collectionID === this.nodes.collectionID);\n      item.dataset[ni] = this.nodes.export();\n      const ei = item.dataset\n        .findIndex(e => e.collectionID === this.edges.collectionID);\n      item.dataset[ei] = this.edges.export();\n      const vi = item.views\n        .findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"network\",\n      nodes: this.nodes.collectionID,\n      edges: this.edges.collectionID,\n      nodeColor: this.nodeColor,\n      nodeSize: this.nodeSize,\n      nodeLabel: this.nodeLabel,\n      nodeLabelColor: this.nodeLabelColor,\n      edgeColor: this.edgeColor,\n      edgeWidth: this.edgeWidth,\n      edgeLabel: this.edgeLabel,\n      edgeLabelColor: this.edgeLabelColor,\n      connThldField: this.connThldField,\n      currentConnThld: this.currentConnThld,\n      minConnThld: this.minConnThld,\n      fieldTransform: this.transform,\n      coords: this.coords\n    };\n  }\n}\n","\n/** @module network/communityDetection */\n\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  const nodeField = option.nodeField || 'index';\n  const weightField = option.weightField || 'weight';\n  if (!edges.length) {\n    const community = {};\n    nodes.forEach(e => { community[e] = option.nulliso ? null : e; });\n    return community;\n  }\n  const ns = nodes.map(e => e[nodeField]);\n  const es = edges.map(e => ({\n    source: e.source[nodeField], target: e.target[nodeField],\n    weight: e[weightField]\n  }));\n  const clusters = {};\n  const community = jLouvain().nodes(ns).edges(es)();\n  Object.entries(community).forEach(e => {\n    if (!clusters.hasOwnProperty(e[1])) {\n      clusters[e[1]] = [];\n    }\n    clusters[e[1]].push(e[0]);\n  });\n  // Sort by cluster size\n  Object.entries(clusters)\n    .sort((a, b) => a[1].length < b[1].length)\n    .forEach((cluster, i) => {\n      if (cluster[1].length === 1) {\n        community[cluster[1][0]] = option.nulliso ? null : i;\n      } else {\n        cluster[1].forEach(e => {\n          community[e] = i;\n        });\n      }\n    });\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\nimport {default as box} from './formBox.js';\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .on('input', function () {\n        const valid = box.formValid(selection);\n        selection.call(box.setValidity, valid);\n      });\n}\n\nfunction updateSelectBoxOptions(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction selectedRecord(selection) {\n  const value = box.formValue(selection);\n  return selection.selectAll('select option').data()\n      .find(e => e.key === value);\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction updateChecklistItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction checkRequired(selection) {\n  selection.selectAll('input')\n      .on('change', function () {\n        const valid = anyChecked(selection);\n        selection.call(setChecklistValidity, valid);\n      });\n}\n\nfunction updateChecklistValues(selection, values) {\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n  selection.call(setChecklistValidity, true);  // Clear validity state\n}\n\nfunction checklistValues(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistValues(selection).length > 0;\n}\n\nfunction setChecklistValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : 'LightPink');\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .attr('viewBox', '0 0 100 10')\n          .attr('preserveAspectRatio', 'none')\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, updateSelectBoxOptions, selectedRecord,\n  checklistBox, updateChecklistItems, checkRequired, updateChecklistValues,\n  checklistValues, anyChecked, setChecklistValidity,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('form-group', true)\n      .classed('align-items-center', true)\n    .append('div')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .text(label);\n\n  const minBox = selection.append('div');\n  minBox.append('label').text('min');\n  minBox.append('input').classed('min', true);\n\n  const maxBox = selection.append('div');\n  maxBox.append('label').text('max');\n  maxBox.append('input').classed('max', true);\n\n  selection.selectAll('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-0', true);\n\n  selection.selectAll('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true);\n\n  selection.selectAll('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'number');\n\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\n\nfunction linearRange(selection, min, max, step) {\n  selection.selectAll('.min, .max')\n      .attr('min', min || null)\n      .attr('max', max || null)\n      .attr('step', step || null)\n      .attr('required', 'required')\n      .on('input', function () {\n        const valid = linearValid(this, step);\n        d3.select(this)\n          .style('background-color', valid ? null : '#ffcccc');\n        selection.select('.invalid-feedback')\n          .style('display', linearRangeValid(selection) ? 'none': 'inherit');\n      })\n      .dispatch('input');\n}\n\n\nfunction logRange(selection) {\n  selection.selectAll('.min, .max')\n      .attr('required', 'required')\n      .on('input', function () {\n        const valid = logValid(this);\n        d3.select(this)\n          .style('background-color', valid ? null : '#ffcccc');\n        selection.select('.invalid-feedback')\n          .style('display', logRangeValid(selection) ? 'none': 'inherit');\n      })\n      .dispatch('input');\n}\n\n\nfunction updateRangeValues(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n  selection.selectAll('.min,.max')\n      .dispatch('input', {bubbles: true});\n}\n\n\nfunction linearValid(node, step) {\n  // If step is not specified, accept stepMismatch\n  const stepm = step ? false : node.validity.stepMismatch;\n  return  node.checkValidity() || stepm;\n}\n\n\nfunction linearRangeValid(selection) {\n  const step = selection.select('.min').attr('step');\n  const minValid = linearValid(selection.select('.min').node(), step);\n  const maxValid = linearValid(selection.select('.max').node(), step);\n  return minValid && maxValid;\n}\n\n\nfunction logValid(node) {\n  // Accept stepMismatch\n  const stepm = node.validity.stepMismatch;\n  return (node.checkValidity() || stepm) && node.value > 0;\n}\n\n\nfunction logRangeValid(selection) {\n  const minPos = logValid(selection.select('.min').node());\n  const maxPos = logValid(selection.select('.max').node());\n  return linearRangeValid(selection) && minPos && maxPos;\n}\n\n\nfunction rangeValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('form-group', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .text(label);\n\n  const minBox = selection.append('div');\n  minBox.append('label').text('min');\n  minBox.append('input').classed('min', true);\n\n  const midBox = selection.append('div');\n  midBox.append('label').text('mid');\n  midBox.append('input').classed('mid', true);\n\n  const maxBox = selection.append('div');\n  maxBox.append('label').text('max');\n  maxBox.append('input').classed('max', true);\n\n  selection.on('change', () => {\n    // avoid update by mousemove on the colorpicker\n    d3.event.stopPropagation();\n  });\n\n  selection.selectAll('div')\n      .classed('form-group', true)\n      .classed('col-3', true)\n      .classed('mb-0', true);\n\n  selection.selectAll('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true);\n\n  selection.selectAll('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorRangeValues(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.mid').property('value', range[1]);\n  selection.select('.max').property('value', range[2]);\n}\n\n\nfunction colorRangeValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.mid').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\nexport default {\n  rangeBox, linearRange, logRange, updateRangeValues,\n  rangeValues, linearRangeValid, logRangeValid,\n  colorRangeBox, updateColorRangeValues, colorRangeValues\n};\n","\n/** @module component/dropdown */\n\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction dropdownFormGroup(selection, label) {\n  const id = misc.uuidv4().slice(0, 8);\n  selection.classed('mb-3', true)\n    .append('div')\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text(label);\n  selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true);\n}\n\n\nexport default {\n  dropdownFormGroup\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\nimport {default as dropdown} from './dropdown.js';\nimport {default as box} from './formBox.js';\nimport {default as lbox} from './formListBox.js';\nimport {default as rbox} from './formRangeBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, colorScales) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('colorscale', true)\n      .classed('mb-2', true)\n      .call(lbox.colorScaleBox, 'Colorscale')\n      .call(lbox.colorScaleBoxItems, colorScales);\n\n  // Custom colorscale\n  const collapse = selection.append('div')\n      .call(dropdown.dropdownFormGroup, 'Custom color')\n    .select('.card-body')\n      .classed('p-2', true);\n\n  const customColorRanges = [\n    {key: 'continuous', name: 'Continuous'},\n    {key: 'two-piece', name: 'Two-piece'}\n  ];\n  collapse.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Range type')\n      .call(lbox.updateSelectBoxOptions, customColorRanges);\n  collapse.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorRangeBox, 'Range');\n  collapse.append('div')\n      .classed('unknown', true)\n      .classed('mb-1', true)\n      .call(box.colorBox, 'Unknown');\n}\n\n\nfunction updateColorRangeGroup(selection, cscale, range, unknown) {\n  const customRange = () => {\n    const cs = lbox.colorScaleBoxValue(selection.select('.colorscale'));\n    const rg = box.formValue(selection.select('.rangetype'));\n    const customScale = cs === 'custom';\n    selection.selectAll('.rangetype, .range, .unknown')\n        .selectAll('select, input')\n        .property('disabled', !customScale);\n    selection.select('.range').select('.mid')\n        .property('disabled', !customScale || rg === 'continuous');\n  };\n  selection.select('.colorscale')\n      .call(lbox.updateColorScaleBox, cscale)\n      .on('change', function () {\n        customRange();\n      });\n  const rtype = range.length === 2 ? 'continuous' : 'two-piece';\n  selection.select('.rangetype')\n      .call(box.updateFormValue, rtype)\n      .on('change', function () {\n        customRange();\n      })\n      .dispatch('change');\n  const rboxValues = range.length === 2  ? [range[0], null, range[1]] : range;\n  selection.select('.range')\n      .call(rbox.updateColorRangeValues, rboxValues)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n  selection.select('.unknown')\n      .call(box.updateFormValue, unknown)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n}\n\n\nfunction colorGroupValues(selection) {\n  const colorScale = lbox.colorScaleBoxItem(selection.select('.colorscale'));\n  const rtype = box.formValue(selection.select('.rangetype'));\n  const range = rbox.colorRangeValues(selection.select('.range'));\n  const unknown = box.formValue(selection.select('.unknown'));\n  return {\n    color: colorScale.key,\n    colorScaleType: colorScale.type,\n    range: rtype === 'continuous' ? [range[0], range[2]] : range,\n    unknown: unknown\n  };\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection) {\n  selection.classed('mb-3', true);\n\n  // Scale type\n  const scaleOptions = [\n    {key: 'linear', name: 'Linear'},\n    {key: 'log', name: 'Log'}\n  ];\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Scale')\n      .call(lbox.updateSelectBoxOptions, scaleOptions)\n      .on('change', function () {\n        const isLog = box.formValue(d3.select(this)) === 'log';\n        selection.select('.domain')\n          .call(isLog ? rbox.logRange : rbox.linearRange)\n          .call(badge.updateInvalidMessage,\n                isLog ? 'Please provide a valid range (larger than 0)'\n                : 'Please provide a valid number');\n      });\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'Domain');\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.scale')\n      .call(box.updateFormValue, scale)\n      .dispatch('change');\n  selection.select('.domain')\n      .call(rbox.updateRangeValues, domain);\n}\n\n\nfunction scaleBoxGroupValid(selection) {\n  const isLog = box.formValue(selection.select('.scale')) === 'log';\n  const dm = selection.select('.domain');\n  return isLog ? rbox.logRangeValid(dm) : rbox.linearRangeValid(dm);\n}\n\n\nfunction scaleGroupValues(selection) {\n  const scale = box.formValue(selection.select('.scale'));\n  const domain = rbox.rangeValues(selection.select('.domain'));\n  return {\n    scale: scale || 'linear',\n    domain: domain\n  };\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorGroupValues,\n  scaleBoxGroup, updateScaleBoxGroup, scaleGroupValues, scaleBoxGroupValid\n};\n","\n/** @module component/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction colorControlBox(selection, colorScales, fieldName) {\n  // Color field\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n\n  // Colorscale and custom range\n  selection.append('div')\n      .classed('range', true)\n      .call(group.colorRangeGroup, colorScales)\n      .on('change', function () {\n        const values = group.colorGroupValues(d3.select(this));\n        const noScale = ['categorical', 'monocolor']\n          .includes(values.colorScaleType);\n        selection.select('.scale').selectAll('select,input')\n            .property('disabled', noScale);\n      });\n\n  // Scale\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n\n  // Legend\n  selection.append('div')\n      .classed('legend', true)\n      .call(box.checkBox, 'Show legend');\n}\n\n\nfunction updateColorControl(selection, fieldOptions, colorState) {\n  selection.select('.field')\n      .call(lbox.updateSelectBoxOptions, fieldOptions)\n      .call(box.updateFormValue, colorState.field);\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, colorState.color,\n            colorState.range, colorState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, colorState.scale, colorState.domain)\n      .dispatch('change');\n  selection.select('.legend')\n      .call(box.updateCheckBox, colorState.legend);\n}\n\n\nfunction colorControlValid(selection) {\n  return group.scaleBoxGroupValid(selection.select('.scale'));\n}\n\n\nfunction colorControlState(selection) {\n  const range = group.colorGroupValues(selection.select('.range'));\n  const scale = group.scaleGroupValues(selection.select('.scale'));\n  return {\n    field: box.formValue(selection.select('.field')),\n    color: range.color,\n    range: range.range,\n    unknown: range.unknown,\n    scale: range.colorScaleType === 'categorical' ? 'ordinal': scale.scale,\n    domain: scale.domain,\n    legend: box.checkBoxValue(selection.select('.legend'))\n  };\n}\n\n\nfunction sizeControlBox(selection, fieldName) {\n  // Size field\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n\n  // Size range\n  selection.append('div')\n      .classed('range', true)\n      .classed('mb-2', true)\n      .call(rbox.rangeBox, 'Range')\n      .call(rbox.linearRange, 0.1, 999, 0.1)\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid range (0.1-999)');\n\n  // Size unknown\n  selection.append('div')\n      .classed('unknown', true)\n      .call(box.numberBox, 'Unknown')\n      .call(box.updateNumberRange, 0.1, 999, 0.1)\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (0.1-999)')\n    .select('input')\n      .classed('col-8', false)\n      .classed('col-3', true);\n\n  // Size scale\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateSizeControl(selection, fieldOptions, sizeState) {\n  selection.select('.field')\n      .call(lbox.updateSelectBoxOptions, fieldOptions)\n      .call(box.updateFormValue, sizeState.field);\n  selection.select('.range')\n      .call(rbox.updateRangeValues, sizeState.range);\n  selection.select('.unknown')\n      .call(box.updateFormValue, sizeState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, sizeState.scale, sizeState.domain);\n}\n\n\nfunction sizeControlValid(selection) {\n  const rangeValid = rbox.linearRangeValid(selection.select('.range'));\n  const unkValid = box.formValid(selection.select('.unknown'));\n  const scaleValid = group.scaleBoxGroupValid(selection.select('.scale'));\n  return rangeValid && unkValid && scaleValid;\n}\n\n\nfunction sizeControlState(selection) {\n  const scale = group.scaleGroupValues(selection.select('.scale'));\n  return {\n    field: box.formValue(selection.select('.field')),\n    range: rbox.rangeValues(selection.select('.range')),\n    unknown: box.formValue(selection.select('.unknown')),\n    scale: scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction labelControlBox(selection, colorScales) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'Show labels');\n\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Text field');\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Font size')\n      .call(box.updateNumberRange, 0.1, 999, 0.1)\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (0.1-999)')\n    .select('.form-control')\n      .attr('required', 'required');\n\n  // nodeLabelColor\n  selection.call(colorControlBox, colorScales, 'Color field');\n  // TODO: not implemented yet\n  selection.select('.legend input').property('disabled', true);\n}\n\n\nfunction updateLabelControl(selection, fieldOptions,\n                               labelState, colorState) {\n  selection.select('.visible')\n      .call(box.updateCheckBox, labelState.visible);\n  selection.select('.text')\n      .call(lbox.updateSelectBoxOptions, fieldOptions)\n      .call(box.updateFormValue, labelState.field);\n  selection.select('.size')\n      .call(box.updateFormValue, labelState.size);\n  selection.call(updateColorControl, fieldOptions, colorState);\n}\n\n\nfunction labelControlValid(selection) {\n  const fontValid = box.formValid(selection.select('.size'));\n  return fontValid && colorControlValid(selection);\n}\n\n\nfunction labelControlState(selection) {\n  return {\n    label: {\n      field: box.formValue(selection.select('.text')),\n      size: box.formValue(selection.select('.size')),\n      visible: box.checkBoxValue(selection.select('.visible'))\n    },\n    labelColor: colorControlState(selection)\n  };\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nexport default {\n  colorControlBox, updateColorControl, colorControlValid, colorControlState,\n  sizeControlBox, updateSizeControl, sizeControlValid, sizeControlState,\n  labelControlBox, updateLabelControl, labelControlValid, labelControlState,\n  controlBoxFrame, controlBoxNav, controlBoxItem\n};\n","\n/** @module network/similarity */\n\nimport _ from 'lodash';\n\n\nfunction explorativeNetwork(nodes, edges) {\n  let baseFactor = 0;\n  let adjField = 'adjacency';\n  let sourceField = 'source';\n  let targetField = 'target';\n  let weightField = 'weight';\n\n  function expnet() {\n    const elevations = {};\n    nodes.forEach((n, i) => {\n      if (!n.adjacency.length) return 0;\n      elevations[i] = _.max(n.adjacency.map(e => edges[e[1]].weight));\n    });\n    const pathWeights = {};\n    edges.forEach((e, i) => {\n      const mn = _.min([elevations[e.source], elevations[e.target]]);\n      pathWeights[i] = (e.weight - baseFactor) / (mn - baseFactor);\n    });\n    return {\n      elevations: elevations, pathWeights: pathWeights\n    };\n  }\n\n  expnet.baseFactor = function (bf) {\n    baseFactor = bf;\n    return expnet;\n  };\n\n  return expnet;\n}\n\n\nexport default {\n  explorativeNetwork\n};\n","\n/** @module network/component */\n\nimport d3 from 'd3';\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as legend} from '../component/legend.js';\nimport {default as transform} from '../component/transform.js';\n\nimport {default as expnet} from './explorativeNetwork.js';\n\nconst svgWidth = 180;  //TODO\nconst svgHeight = 180;  //TODO\n\n\nfunction updateNodes(selection, records, showStruct) {\n  const nodes = selection.selectAll('.node')\n    .data(records, d => d.index);\n  nodes.exit().remove();\n  const entered = nodes.enter()\n    .append('g')\n      .attr('class', 'node')\n      .call(updateNodeCoords);\n  entered.append('circle')\n      .attr('class', 'node-symbol');\n  entered.append('g')\n      .attr('class', 'node-content')\n      .attr('transform', `translate(${-svgWidth / 2},${-svgHeight / 2})`);\n  entered.append('text')\n      .attr('class', 'node-label')\n      .attr('x', 0)\n      .attr('text-anchor', 'middle');\n  entered.append('foreignObject')\n      .attr('class', 'node-html')\n    .append('xhtml:div');\n  const merged = entered.merge(nodes);\n  if (showStruct) {\n    merged.select('.node-content').html(d => d.structure);\n  } else {\n    merged.select('.node-content').select('svg').remove();\n  }\n}\n\n\nfunction updateEdges(selection, records) {\n  const edges = selection.selectAll('.link')\n    .data(records, d => `${d.source.index}_${d.target.index}`);\n  edges.exit().remove();\n  const entered = edges.enter()\n    .append('g')\n      .attr('class', 'link');\n  entered.append('line')\n      .attr('class', 'edge-line')\n      .style('stroke-opacity', 0.6);\n  entered.append('text')\n      .attr('class', 'edge-label')\n      .attr('text-anchor', 'middle');\n  // draw all components and then\n  entered.call(updateEdgeCoords);\n}\n\n\nfunction updateNodeAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.nodeColor);\n  const sizeConv = scale.scaleFunction(state.nodeSize);\n  const labelColorConv = scale.scaleFunction(state.nodeLabelColor);\n  const field = state.nodes.fields\n    .find(e => e.key === state.nodeLabel.field);\n  const textConv = value => {\n    return field.format === 'd3_format'\n      ? misc.formatNum(value, field.d3_format) : value;\n  };\n  selection.selectAll('.node').select('.node-symbol')\n      .attr('r', d => sizeConv(d[state.nodeSize.field]))\n      .style('fill', d => colorConv(d[state.nodeColor.field]));\n  // TODO: tidy up (like rowFactory?)\n  if (field.format === 'html') {\n    const htwidth = 200;\n    const fo = selection.selectAll('.node').select('.node-html');\n    fo.attr('x', -htwidth / 2)\n      .attr('y', d => state.focusedView ? svgWidth / 2 - 10\n        : parseFloat(sizeConv(d[state.nodeSize.field])))\n      .attr('width', htwidth);\n    fo.select('div')\n      .style('font-size', `${state.nodeLabel.size}px`)\n      .style('color', d => labelColorConv(d[state.nodeLabelColor.field]))\n      .style('text-align', 'center')\n      .style('display', state.nodeLabel.visible ? 'block' : 'none')\n      .html(d => d[state.nodeLabel.field]);\n    selection.selectAll('.node').select('.node-label').text('');\n  } else {\n    selection.selectAll('.node').select('.node-label')\n        .attr('font-size', state.nodeLabel.size)\n        .attr('y', d => state.focusedView ? svgWidth / 2 - 10\n          : parseFloat(sizeConv(d[state.nodeSize.field])))\n        .attr('visibility', state.nodeLabel.visible ? 'inherit' : 'hidden')\n        .style('fill', d => labelColorConv(d[state.nodeLabelColor.field]))\n        .text(d => textConv(d[state.nodeLabel.field]));\n    selection.selectAll('.node').select('.node-html div').html('');\n  }\n}\n\n\nfunction updateEdgeAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.edgeColor);\n  const widthConv = scale.scaleFunction(state.edgeWidth);\n  const labelColorConv = scale.scaleFunction(state.edgeLabelColor);\n  const field = state.edges.fields\n    .find(e => e.key === state.edgeLabel.field);\n  const textConv = value => {\n    return field.format === 'd3_format'\n      ? misc.formatNum(value, field.d3_format) : value;\n  };\n  selection.selectAll('.link').select('.edge-line')\n    .style('stroke', d => colorConv(d[state.edgeColor.field]))\n    .style('stroke-width', d => widthConv(d[state.edgeWidth.field]));\n  selection.selectAll('.link').select('.edge-label')\n    .attr('font-size', state.edgeLabel.size)\n    .attr('visibility', state.edgeLabel.visible ? 'inherit' : 'hidden')\n    .style('fill', d => labelColorConv(d[state.edgeLabelColor.field]))\n    .text(d => textConv(d[state.edgeLabel.field]));\n}\n\n\nfunction updateNodeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.x}, ${d.y})`);\n}\n\n\nfunction updateEdgeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.sx}, ${d.sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.tx - d.sx)\n    .attr('y2', d => d.ty - d.sy);\n  selection.select('.edge-label')\n    .attr('x', d => (d.tx - d.sx) / 2)\n    .attr('y', d => (d.ty - d.sy) / 2);\n}\n\n\nfunction updateAttrs(selection, state) {\n  selection.call(updateNodeAttrs, state);\n  selection.call(updateEdgeAttrs, state);\n}\n\n\nfunction updateComponents(selection, state) {\n  const nodesToRender = state.nodesToRender();\n  const numNodes = nodesToRender.length;\n  if (state.enableFocusedView) {\n    state.focusedView = numNodes < state.focusedViewThreshold;\n  }\n  if (state.enableOverlookView) {\n    state.overlookView = numNodes > state.overlookViewThreshold;\n  }\n  const edgesToRender = state.overlookView ? [] : state.edgesToRender();\n  selection.select('.node-layer')\n    .call(updateNodes, nodesToRender, state.focusedView);\n  selection.select('.edge-layer')\n    .call(updateEdges, edgesToRender);\n  selection.call(updateAttrs, state);\n}\n\n\nfunction moveNode(selection, x, y) {\n  selection.attr('transform', `translate(${x}, ${y})`);\n}\n\n\nfunction moveEdge(selection, sx, sy, tx, ty) {\n  selection.attr('transform', `translate(${sx}, ${sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', tx - sx)\n    .attr('y2', ty - sy);\n  selection.select('.edge-label')\n    .attr('x', (tx - sx) / 2)\n    .attr('y', (ty - sy) / 2);\n}\n\n\nfunction move(selection, node, x, y) {\n  const n = d3.select(node).call(moveNode, x, y).datum();\n  selection.select('.edge-layer')\n    .selectAll(\".link\")\n    .filter(d => n.adjacency.map(e => e[1]).includes(d.num))\n    .each(function (d) {\n      if (n.index === d.source.index) {\n        d3.select(this).call(moveEdge, x, y, d.tx, d.ty);\n      } else if (n.index === d.target.index) {\n        d3.select(this).call(moveEdge, d.sx, d.sy, x, y);\n      }\n    });\n}\n\n\nfunction networkView(selection, state) {\n  selection.call(transform.view, state);\n  const field = selection.select('.field');\n  const edges = field.append('g').classed('edge-layer', true);\n  const nodes = field.append('g').classed('node-layer', true);\n  const legendGroup = selection.append('g')\n      .classed('legends', true);\n  legendGroup.append('g')\n      .classed('nodecolor', true)\n      .call(legend.colorBarLegend);\n\n  // Apply changes in datasets\n  state.updateAllNotifier = () => {\n    state.updateWorkingCopy();\n    // Explorative network\n    if (!state.nodes.fields.includes('elevation')) {\n      const expn = expnet.explorativeNetwork(state.ns, state.es)\n        .baseFactor(state.minConnThld)();\n      const elevmap = {\n        key: 'index',\n        field: {key: 'elevation', name: 'Elevation', d3_format: '.3f'},\n        mapping: expn.elevations\n      };\n      state.nodes.joinFields(elevmap);\n      const pathmap = {\n        key: 'index',\n        field: {key: 'pweight', name: 'Path weight', d3_format: '.3f'},\n        mapping: expn.pathWeights\n      };\n      // TODO:\n      state.edges.contents[0].records.forEach((e, i) => {\n        e.pweight = expn.pathWeights[i];\n      });\n      if (!state.edges.contents[0].fields.find(e => e.key === 'pweight')) {\n        state.edges.contents[0].fields.push(pathmap.field);\n      }\n      state.edges.addField(pathmap.field);\n      state.updateWorkingCopy();\n    }\n    state.updateControlBoxNotifier();  // Update selectBox options\n    state.setForceNotifier();\n    state.updateComponentNotifier();\n  };\n  // Apply changes in nodes and edges displayed\n  state.updateComponentNotifier = () => {\n    state.updateLegendNotifier();\n    const coords = state.ns.map(e => ({x: e.x, y: e.y}));\n    state.setAllCoords(coords);\n    selection.call(updateComponents, state);\n    state.updateInteractionNotifier();  // Apply drag events to each nodes\n  };\n  state.updateNodeNotifier = () => {\n    nodes.call(updateNodes, state.nodesToRender());\n    state.updateLegendNotifier();\n  };\n  state.updateEdgeNotifier = () => {\n    edges.call(updateEdges, state.edgesToRender());\n  };\n  state.updateNodeAttrNotifier = () => {\n    nodes.call(updateNodeAttrs, state);\n    state.updateLegendNotifier();\n  };\n  state.updateEdgeAttrNotifier = () => {\n    edges.call(updateEdgeAttrs, state);\n  };\n  state.updateLegendNotifier = () => {\n    legendGroup.call(legend.updateLegendGroup,\n                     state.viewBox, state.legendOrient);\n    legendGroup.select('.nodecolor')\n        .attr('visibility', state.nodeColor.legend ? 'inherit' : 'hidden')\n        .call(legend.updateColorBarLegend, state.nodeColor);\n  };\n}\n\n\nexport default {\n  updateNodes, updateEdges, updateNodeCoords, updateEdgeCoords,\n  updateNodeAttrs, updateEdgeAttrs, updateAttrs, updateComponents,\n  move, moveEdge, networkView\n};\n","\n/** @module network/interaction */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as transform} from '../component/transform.js';\n\nimport {default as component} from './component.js';\n\n\nfunction dragListener(selection, state) {\n  return d3.drag()\n    .on('drag', function () {\n      selection.call(component.move, this, d3.event.x, d3.event.y);\n    })\n    .on('end', function (d) {\n      state.setCoords(d.index, d3.event.x, d3.event.y);\n    });\n}\n\n\nfunction multiDragListener(selection, state) {\n  const origin = {x: 0, y: 0};\n  return d3.drag()\n    .on('start', function () {\n      origin.x = d3.event.x;\n      origin.y = d3.event.y;\n    })\n    .on('drag', function () {\n      const dx = d3.event.x - origin.x;\n      const dy = d3.event.y - origin.y;\n      d3.select(this).attr('transform', `translate(${dx}, ${dy})`);\n      selection.selectAll('.selected-nodes .node')\n        .each(function (n) {\n          const newX = n.x + dx;\n          const newY = n.y + dy;\n          selection.selectAll('.edge-layer .link')\n            .filter(d => n.adjacency.map(e => e[1]).includes(d.num))\n            .each(function (d) {\n              if (n.index === d.source.index) {\n                d3.select(this)\n                    .call(component.moveEdge, newX, newY, d.tx, d.ty);\n              } else if (n.index === d.target.index) {\n                d3.select(this)\n                    .call(component.moveEdge, d.sx, d.sy, newX, newY);\n              }\n            });\n        });\n    })\n    .on('end', function () {\n      const dx = d3.event.x - origin.x;\n      const dy = d3.event.y - origin.y;\n      selection.selectAll('.selected-nodes .node')\n        .each(function (n) {\n          const newX = n.x + dx;\n          const newY = n.y + dy;\n          state.setCoords(n.index, newX, newY);\n          d3.select(this).attr('transform', `translate(${newX}, ${newY})`);\n        });\n      selection.selectAll('.selected-edges .link')\n          .attr('transform', d => `translate(${d.sx}, ${d.sy})`);\n      d3.select(this).attr('transform', `translate(0, 0)`);\n    });\n}\n\n\nfunction zoomListener(selection, state) {\n  let prevTransform = {x: 0, y: 0, k: 1};\n  selection\n      .on(\"dblclick.zoom\", null)  // disable double-click zoom\n      .on('.drag', null);  // disable rectSelect\n  return d3.zoom()\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(transform.transform, t.x, t.y, t.k);\n      // Smooth transition\n      if (!state.focusedView) {\n        const p = prevTransform;\n        const xMoved = t.x > p.x + 20 || t.x < p.x - 20;\n        const yMoved = t.y > p.y + 20 || t.y < p.y - 20;\n        const zoomIn = t.k > p.k;\n        if (xMoved || yMoved && !zoomIn) {\n          state.setTransform(t.x, t.y, t.k);\n          prevTransform = {x: t.x, y: t.y, k: t.k};\n          state.updateComponentNotifier();\n        }\n      }\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      prevTransform = {x: t.x, y: t.y, k: t.k};\n      state.updateComponentNotifier();\n    });\n}\n\n\nfunction rectSelectListener(selection, state) {\n  selection.on('.zoom', null);  // disable zoom\n  const rect = selection.select('.interactions .rect-select');\n  const origin = {x: 0, y: 0};\n  let initSel = [];\n  return d3.drag()\n    .on('start', function () {\n      origin.x = d3.event.x;\n      origin.y = d3.event.y;\n      initSel = state.ns.map(e => e.selected);\n      rect.attr('visibility', 'visible')\n          .attr('x', origin.x).attr('y', origin.y);\n    })\n    .on('drag', function () {\n      const left = Math.min(origin.x, d3.event.x);\n      const width = Math.abs(origin.x - d3.event.x);\n      const top = Math.min(origin.y, d3.event.y);\n      const height = Math.abs(origin.y - d3.event.y);\n      const tf = state.transform;\n      const xConv = x => (x - tf.x) / tf.k;\n      const yConv = y => (y - tf.y) / tf.k;\n      selection.selectAll('.node')\n        .each(function(d) {\n          const selected = d3.select(this.parentNode).classed('selected-nodes');\n          const inside = d.x > xConv(left) && d.y > yConv(top)\n              && d.x < xConv(left + width) && d.y < yConv(top + height);\n          const sel = selected !== inside;\n          d3.select(this)\n            .select('.node-symbol')\n              .attr('stroke', sel ? 'red' : null)\n              .attr('stroke-width', sel ? 10 : null)\n              .attr('stroke-opacity', sel ? 0.5 : 0);\n        rect.attr('x', left).attr('y', top)\n            .attr('width', width).attr('height', height);\n\n      });\n    })\n    .on('end', function () {\n      const left = Math.min(origin.x, d3.event.x);\n      const width = Math.abs(origin.x - d3.event.x);\n      const top = Math.min(origin.y, d3.event.y);\n      const height = Math.abs(origin.y - d3.event.y);\n      const tf = state.transform;\n      const xConv = x => (x - tf.x) / tf.k;\n      const yConv = y => (y - tf.y) / tf.k;\n      state.ns.filter(\n        n => n.x > xConv(left) && n.y > yConv(top)\n          && n.x < xConv(left + width) && n.y < yConv(top + height)\n      ).forEach(n => {\n        n.selected = !initSel[n.index];\n        // Selection should be an induced subgraph of the network\n        n.adjacency.forEach(adj => {\n          state.es[adj[1]].selected = (\n            state.ns[n.index].selected && state.ns[adj[0]].selected);\n        });\n      });\n      state.updateComponentNotifier();\n      rect.attr('visibility', 'hidden')\n          .attr('width', 0).attr('height', 0);\n    });\n}\n\n\nfunction selectListener(selection, state) {\n  return sel => {\n    sel.on('touchstart', function () { d3.event.preventDefault(); })\n        .on('touchmove', function () { d3.event.preventDefault(); })\n        .on('click.select', function () {\n          d3.event.stopPropagation();\n          const n = d3.select(this).datum().index;\n          const isSel = state.ns[n].selected;\n          state.ns.forEach(e => { e.selected = false; });\n          state.es.forEach(e => { e.selected = false; });\n          state.ns[n].selected = !isSel;\n          state.updateComponentNotifier();\n        });\n  };\n}\n\n\nfunction multiSelectListener(selection, state) {\n  return sel => {\n    sel.on('touchstart', function () { d3.event.preventDefault(); })\n        .on('touchmove', function () { d3.event.preventDefault(); })\n        .on('click.select', function () {\n          d3.event.stopPropagation();\n          const data = d3.select(this).datum();\n          const n = data.index;\n          state.ns[n].selected = !state.ns[n].selected;\n          // Selection should be an induced subgraph of the network\n          data.adjacency.forEach(adj => {\n            state.es[adj[1]].selected = (\n              state.ns[n].selected && state.ns[adj[0]].selected);\n          });\n          state.updateComponentNotifier();\n        });\n  };\n}\n\n\nfunction resume(selection, tf) {\n  selection\n      .call(transform.transform, tf.x, tf.y, tf.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(tf.x, tf.y).scale(tf.k)\n      );\n}\n\n\n// TODO: refactor\n// Custom updater for interactive mode\nfunction updateComponents(selection, state) {\n  const nodesToRender = state.nodesToRender();\n  const [nodesSelected, nodesNotSelected] = _.partition(\n    nodesToRender, d => d.selected);\n  const numNodes = nodesToRender.length;\n  if (state.enableFocusedView) {\n    state.focusedView = numNodes < state.focusedViewThreshold;\n  }\n  if (state.enableOverlookView) {\n    state.overlookView = numNodes > state.overlookViewThreshold;\n  }\n  const edgesToRender = state.overlookView ? [] : state.edgesToRender();\n  const [edgesSelected, edgesNotSelected] = _.partition(\n      edgesToRender, d => d.selected);\n  selection.select('.node-layer')\n      .call(component.updateNodes, nodesNotSelected, state.focusedView)\n    .selectAll('.node .node-symbol')\n      .attr('stroke-opacity', 0);\n  selection.select('.edge-layer')\n      .call(component.updateEdges, edgesNotSelected);\n  selection.select('.selected-nodes')\n      .call(component.updateNodes, nodesSelected, state.focusedView)\n    .selectAll('.node .node-symbol')\n      .attr('stroke', 'red')\n      .attr('stroke-width', 10)\n      .attr('stroke-opacity', 0.5);\n  selection.select('.selected-edges')\n      .call(component.updateEdges, edgesSelected);\n  selection.call(component.updateAttrs, state);\n}\n\n\nfunction setInteraction(selection, state) {\n  // Object selection layer\n  const selectedObj = selection.select('.field')\n    .append('g').classed('selected-obj', true);\n  selectedObj.append('g').classed('selected-edges', true);\n  selectedObj.append('g').classed('selected-nodes', true);\n\n  // Rectangle selection layer\n  selection.append('g')\n      .classed('interactions', true)\n    .append('rect')\n      .classed('rect-select', true)\n      .attr('fill', 'none')\n      .attr('stroke', 'black')\n      .attr('stroke-width', 1)\n      .attr('stroke-dasharray', '5,5')\n      .attr('visibility', 'hidden');\n\n  // Background click to clear selection\n  selection\n      .on('touchstart', function () { d3.event.preventDefault(); })\n      .on('touchmove', function () { d3.event.preventDefault(); })\n      .on('click', function () {\n        if (event.shiftKey) d3.event.preventDefault();\n        state.ns.forEach(e => { e.selected = false; });\n        state.es.forEach(e => { e.selected = false; });\n        state.updateComponentNotifier();\n      });\n\n  // Enter multiple select mode\n  document.addEventListener('keydown', event => {\n    if (event.key !== 'Shift') return;\n    selection.style(\"cursor\", \"crosshair\");\n    state.zoomListener = rectSelectListener(selection, state);\n    state.selectListener = multiSelectListener(selection, state);\n    state.updateInteractionNotifier();\n  });\n\n  // Exit multiple select mode\n  document.addEventListener('keyup', event => {\n    if (event.key !== 'Shift') return;\n    selection.style(\"cursor\", \"auto\");\n    state.zoomListener = zoomListener(selection, state);\n    state.selectListener = selectListener(selection, state);\n    state.updateInteractionNotifier();\n  });\n\n  // Event listeners\n  state.zoomListener = zoomListener(selection, state);\n  state.dragListener = dragListener(selection, state);\n  state.selectListener = selectListener(selection, state);\n\n  // Update interaction events\n  state.updateInteractionNotifier = () => {\n    selection.call(state.zoomListener);\n    selection.selectAll('.node')\n        .call(state.selectListener);\n    selection.selectAll('.node-layer .node')\n        .call(state.dragListener);\n    selection.selectAll('.selected-obj')\n        .call(multiDragListener(selection, state));\n    selection.call(resume, state.transform);\n  };\n\n  // Update components\n  state.updateComponentNotifier = () => {\n    state.updateLegendNotifier();\n    const coords = state.ns.map(e => ({x: e.x, y: e.y}));\n    state.setAllCoords(coords);\n    selection.call(updateComponents, state);  // Custom updater\n    state.updateInteractionNotifier();  // Apply drag events to each nodes\n  };\n\n  // Fit to the viewBox\n  state.fitNotifier = () => {\n    state.fitTransform();\n    state.updateComponentNotifier();\n    selection.call(resume, state.transform);\n  };\n}\n\n\nexport default {\n  dragListener, zoomListener, setInteraction\n};\n","\n/** @module network/force */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\nimport {default as interaction} from './interaction.js';\n\n\nconst forceType = [\n  {\n    key: 'aggregate',\n    name: 'Aggregate',\n    force: d3.forceSimulation()\n      .force('link', d3.forceLink().id(d => d.index).distance(60).strength(1))\n      .force('charge',\n        d3.forceManyBody().strength(-600).distanceMin(15).distanceMax(720))\n      .force('collide', d3.forceCollide().radius(90))\n      .force('x', d3.forceX().strength(0.002))\n      .force('y', d3.forceY().strength(0.002))\n  },\n  {\n    key: 'tree',\n    name: 'Tree',\n    force: d3.forceSimulation()\n      .force('link', d3.forceLink().id(d => d.index).distance(60).strength(2))\n      .force('charge',\n        d3.forceManyBody().strength(-6000).distanceMin(15).distanceMax(720))\n      .force('collide', d3.forceCollide().radius(90))\n      .force('x', d3.forceX().strength(0.0002))\n      .force('y', d3.forceY().strength(0.0002))\n  },\n  {\n    key: 'sparse',\n    name: 'Sparse',\n    force: d3.forceSimulation()\n      .force('link', d3.forceLink().id(d => d.index).distance(60).strength(2))\n      .force('charge',\n        d3.forceManyBody().strength(-6000).distanceMin(15).distanceMax(3600))\n      .force('collide', d3.forceCollide().radius(90))\n      .force('x', d3.forceX().strength(0.0002))\n      .force('y', d3.forceY().strength(0.0002))\n  }\n];\n\n\nfunction forceSimulation(type, width, height) {\n  return forceType.find(e => e.key === type).force\n    .force('center', d3.forceCenter(width / 2, height / 2))\n    .stop();\n}\n\n\nfunction forceDragListener(selection, simulation, state) {\n  return d3.drag()\n    .on('start', () => {\n      if (!d3.event.active) state.relaxNotifier();\n    })\n    .on('drag', d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    })\n    .on('end', d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    });\n}\n\n\nfunction stick(selection, simulation, state) {\n  simulation.alpha(0).stop();\n  selection.selectAll('.node')\n    .each(d => {\n      d.fx = d.x;\n      d.fy = d.y;\n    });\n  state.dragListener = interaction.dragListener(selection, state);\n  state.forceActive = false;\n}\n\n\nfunction unstick(selection, simulation, state) {\n  selection.selectAll('.node')\n    .each(d => {\n      d.fx = null;\n      d.fy = null;\n    });\n  state.dragListener = forceDragListener(selection, simulation, state);\n  state.forceActive = true;\n}\n\n\nfunction activate(selection, state) {\n  state.setForceNotifier = () => {\n    const simulation = forceSimulation(\n        state.forceType, state.fieldWidth, state.fieldHeight);\n    simulation.nodes(state.ns)\n      .force('link').links(state.currentEdges());\n    simulation\n      .on('tick', () => {\n        const coords = state.ns.map(e => ({x: e.x, y: e.y}));\n        state.setAllCoords(coords);\n        selection.selectAll(\".node\")\n          .call(component.updateNodeCoords);\n        selection.selectAll(\".link\")\n          .call(component.updateEdgeCoords);\n        state.tickCallback(simulation);\n      })\n      .on('end', () => {\n        state.updateComponentNotifier();\n        state.tickCallback(simulation);\n      });\n    if (state.forceActive) {\n      state.coords ? state.relaxNotifier() : state.restartNotifier();\n    } else {\n      state.stickNotifier();\n    }\n\n    state.stickNotifier = () => {\n      selection.call(stick, simulation, state);\n    };\n    state.relaxNotifier = () => {\n      selection.call(unstick, simulation, state);\n      simulation.alpha(0.1).restart();\n    };\n    state.restartNotifier = () => {\n      selection.call(unstick, simulation, state);\n      simulation.alpha(1).restart();\n    };\n  };\n}\n\n\nexport default {\n  forceType, forceSimulation, activate\n};\n","\n/** @module network/controlBox */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as cscale} from '../common/scale.js';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as cbox} from '../component/controlBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as button} from '../component/button.js';\n\nimport {default as force} from './force.js';\n\n\nfunction mainControlBox(selection, state) {\n  // Zoom\n  selection.append('div')\n      .classed('mb-3', true)\n    .append('div')\n      .classed('fit', true)\n      .call(button.buttonBox, 'Fit to screen', 'primary');\n  // View modes\n  const viewModes = selection.append('div')\n      .classed('mb-3', true);\n    viewModes.append('div')\n      .classed('focused', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Enable focused view');\n    viewModes.append('div')\n      .classed('overlook', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Enable overlook view');\n\n  // Legend\n  const legendOptions = [\n    {key: 'top-left', name: 'Top-left'},\n    {key: 'top-right', name: 'Top-right'},\n    {key: 'bottom-left', name: 'Bottom-left'},\n    {key: 'bottom-right', name: 'Bottom-right'},\n  ];\n  selection.append('div')\n      .classed('legend', true)\n      .classed('mb-3', true)\n      .call(lbox.selectBox, 'Legend')\n      .call(lbox.updateSelectBoxOptions, legendOptions)\n      .on('change', function () {\n        state.legendOrient = box.formValue(d3.select(this));\n        state.updateLegendNotifier();\n      });\n\n  // Network threshold\n  const thldGroup = selection.append('div')\n      .classed('thld-group', true)\n      .classed('mb-3', true);\n  thldGroup.append('div')\n      .classed('field', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Connection');\n  thldGroup.append('div')\n      .classed('thld', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Threshold')\n      .call(box.updateNumberRange, state.minConnThld, 1, 0.01)\n      .call(badge.updateInvalidMessage,\n            `Please provide a valid range (${state.minConnThld}-1.00)`)\n    .select('.form-control')\n      .attr('required', 'required');\n  thldGroup.append('div')\n      .classed('logd', true)\n      .classed('mb-1', true)\n      .call(box.readonlyBox, 'logD');\n  // Force layout\n  const forceBox = selection.append('div')\n      .classed('form-group', true)\n      .classed('form-row', true);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('forcetype', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Force')\n      .call(lbox.updateSelectBoxOptions, force.forceType)\n      .on('change', function () {\n        const value = box.formValue(d3.select(this));\n        state.forceType = value;\n        state.setForceNotifier();\n      });\n  forceBox.append('div')\n      .classed('col-6', true)\n    .append('span')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('mb-1', true)\n      .text('Temperature');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('temperature', true)\n      .classed('progress', true)\n    .append('div')\n      .classed('progress-bar', true)\n      .classed('w-30', true)\n      .attr('id', 'temperature')\n      .attr('role', 'progressbar')\n      .attr('aria-valuemin', 0)\n      .attr('aria-valuemax', 100);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('stick', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Stick nodes');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('restart', true)\n      .classed('mb-1', true)\n      .call(button.buttonBox, 'Activate', 'warning');\n}\n\n\nfunction updateMainControl(selection, state) {\n  // Zoom\n  selection.select('.fit')\n      .on('click', function () { state.fitNotifier(); });\n  // Focused view\n  selection.select('.focused')\n      .call(box.updateCheckBox, state.enableFocusedView)\n      .on('change', function () {\n        state.enableFocusedView = box.checkBoxValue(d3.select(this));\n        state.focusedView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Overlook view\n  selection.select('.overlook')\n      .call(box.updateCheckBox, state.enableOverlookView)\n      .on('change', function () {\n        state.enableOverlookView = box.checkBoxValue(d3.select(this));\n        state.overlookView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Network threshold\n  const thldGroup = selection.select('.thld-group');\n  const thldFields = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  thldGroup.select('.field')\n      .call(lbox.updateSelectBoxOptions, thldFields)\n      .call(box.updateFormValue, state.connThldField);\n  thldGroup.select('.thld')\n      .call(box.updateFormValue, state.currentConnThld);\n  thldGroup.selectAll('.field, .thld')\n      .on('change', function () {\n        if(!box.formValid(thldGroup.select('.thld'))) return;\n        const field = box.formValue(thldGroup.select('.field'));\n        const thld = box.formValue(thldGroup.select('.thld'));\n        state.connThldField = field;\n        state.currentConnThld = thld;\n        thldGroup.select('.logd').dispatch('update');\n        state.setForceNotifier();\n        state.updateComponentNotifier();\n      });\n  thldGroup.select('.logd')\n      .on('update', function () {\n        // Calculate edge density\n        const field = state.connThldField;\n        const thld = state.currentConnThld;\n        const numEdges = state.es.filter(e => e[field] >= thld).length;\n        const n = state.ns.length;\n        const combinations = n * (n - 1) / 2;\n        const logD = d3.format('.2f')(Math.log10(numEdges / combinations));\n        d3.select(this).call(box.updateReadonlyValue, logD);\n      })\n      .dispatch('update');\n\n  // Force layout\n  state.tickCallback = (simulation) => {\n    const alpha = simulation.alpha();\n    const isStopped = alpha <= simulation.alphaMin();\n    const progress = parseInt(isStopped ? 0 : alpha * 100);\n    selection.select('.temperature')\n      .select('.progress-bar')\n        .classed('bg-success', isStopped)\n        .classed('bg-warning', !isStopped)\n        .style('width', `${progress}%`)\n        .attr('aria-valuenow', progress);\n  };\n  selection.select('.stick')\n      .call(box.updateCheckBox, !state.forceActive)\n      .on('change', function () {\n        const value = box.checkBoxValue(d3.select(this));\n        state.forceActive = !value;\n        selection.select('.temperature')\n            .style('background-color', value ? '#a3e4d7' : '#e9ecef')\n          .select('.progress-bar')\n            .style('width', `0%`)\n            .attr('aria-valuenow', 0);\n        value ? state.stickNotifier() : state.relaxNotifier();\n        state.updateComponentNotifier();\n      });\n  selection.select('.restart')\n      .on('click', function () {\n        selection.select('.stick')\n            .call(box.updateCheckBox, false)\n            .dispatch('change');\n        state.restartNotifier();\n      });\n}\n\n\nfunction updateNodeColorControl(selection, state) {\n  const fieldOptions = state.nodes.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateColorControl, fieldOptions, state.nodeColor)\n      .on('change', function() {\n        if (!cbox.colorControlValid(selection)) return;\n        state.nodeColor = cbox.colorControlState(selection);\n        if (state.nodeColor.scale === 'ordinal') {\n          const keys = state.nodes.records().map(e => e[state.nodeColor.field]);\n          state.nodeColor.domain = _.uniq(keys).sort();\n        }\n        state.updateNodeAttrNotifier();\n      });\n}\n\n\nfunction updateEdgeColorControl(selection, state) {\n  const fieldOptions = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  selection\n      .call(cbox.updateColorControl, fieldOptions, state.edgeColor)\n      .on('change', function() {\n        if (!cbox.colorControlValid(selection)) return;\n        state.edgeColor = cbox.colorControlState(selection);\n        if (state.edgeColor.scale === 'ordinal') {\n          const keys = state.edges.records().map(e => e[state.edgeColor.field]);\n          state.edgeColor.domain = _.uniq(keys).sort();\n        }\n        state.updateEdgeAttrNotifier();\n      });\n\n  // TODO: not implemented yet\n  selection.select('.legend input').property('disabled', true);\n}\n\n\nfunction updateNodeSizeControl(selection, state) {\n  const fieldOptions = state.nodes.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateSizeControl, fieldOptions, state.nodeSize)\n      .on('change', function() {\n        if (!cbox.sizeControlValid(selection)) return;\n        state.nodeSize = cbox.sizeControlState(selection);\n        state.updateNodeAttrNotifier();\n      });\n}\n\n\nfunction updateEdgeWidthControl(selection, state) {\n  const fieldOptions = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  selection\n      .call(cbox.updateSizeControl, fieldOptions, state.edgeWidth)\n      .on('change', function() {\n        if (!cbox.sizeControlValid(selection)) return;\n        state.edgeWidth = cbox.sizeControlState(selection);\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction updateNodeLabelControl(selection, state) {\n  const fieldOptions = state.nodes.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateLabelControl, fieldOptions,\n            state.nodeLabel, state.nodeLabelColor)\n      .on('change', function() {\n        if (!cbox.labelControlValid(selection)) return;\n        const values = cbox.labelControlState(selection);\n        state.nodeLabel = values.label;\n        state.nodeLabelColor = values.labelColor;\n        if (state.nodeLabelColor.scale === 'ordinal') {\n          const keys = state.nodes.records()\n            .map(e => e[state.nodeLabelColor.field]);\n          state.nodeLabelColor.domain = _.uniq(keys).sort();\n        }\n        state.updateNodeAttrNotifier();\n      });\n}\n\n\nfunction updateEdgeLabelControl(selection, state) {\n  const fieldOptions = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  selection\n      .call(cbox.updateLabelControl, fieldOptions,\n            state.edgeLabel, state.edgeLabelColor)\n      .on('change', function() {\n        if (!cbox.labelControlValid(selection)) return;\n        const values = cbox.labelControlState(selection);\n        state.edgeLabel = values.label;\n        state.edgeLabelColor = values.labelColor;\n        if (state.edgeLabelColor.scale === 'ordinal') {\n          const keys = state.edges.records()\n            .map(e => e[state.edgeLabelColor.field]);\n          state.edgeLabelColor.domain = _.uniq(keys).sort();\n        }\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    cbox.controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(cbox.controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(cbox.controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(cbox.controlBoxItem, 'control-color')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Size\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-size', 'Size');\n  content.append('div')\n      .classed('control-size', true)\n      .call(cbox.controlBoxItem, 'control-size')\n      .call(cbox.sizeControlBox);\n\n  // Label\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-label', 'Label');\n  content.append('div')\n      .classed('control-label', true)\n      .call(cbox.controlBoxItem, 'control-label')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  // Edge color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-edgecolor', 'eColor');\n  content.append('div')\n      .classed('control-edgecolor', true)\n      .call(cbox.controlBoxItem, 'control-edgecolor')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Edge width\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-edgewidth', 'eWidth');\n  content.append('div')\n      .classed('control-edgewidth', true)\n      .call(cbox.controlBoxItem, 'control-edgewidth')\n      .call(cbox.sizeControlBox);\n\n  // Edge label\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-edgelabel', 'eLabel');\n  content.append('div')\n      .classed('control-edgelabel', true)\n      .call(cbox.controlBoxItem, 'control-edgelabel')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  state.updateControlBoxNotifier = () => {\n    selection.call(updateControlBox, state);\n  };\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControl, state);\n  selection.select('.control-color')\n      .call(updateNodeColorControl, state);\n  selection.select('.control-size')\n      .call(updateNodeSizeControl, state);\n  selection.select('.control-label')\n      .call(updateNodeLabelControl, state);\n  selection.select('.control-edgecolor')\n      .call(updateEdgeColorControl, state);\n  selection.select('.control-edgewidth')\n      .call(updateEdgeWidthControl, state);\n  selection.select('.control-edgelabel')\n      .call(updateEdgeLabelControl, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module networkApp */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as client} from './common/client.js';\nimport {default as idb} from './common/idb.js';\n\nimport {default as badge} from './component/badge.js';\nimport {default as button} from './component/button.js';\nimport {default as modal} from './component/modal.js';\nimport {default as transform} from './component/transform.js';\n\nimport {default as communityDialog} from './dialog/community.js';\nimport {default as renameDialog} from './dialog/rename.js';\n\nimport NetworkState from './network/state.js';\nimport {default as community} from './network/communityDetection.js';\nimport {default as control} from './network/controlBox.js';\nimport {default as component} from './network/component.js';\nimport {default as force} from './network/force.js';\nimport {default as interaction} from './network/interaction.js';\n\n\nfunction app(view, nodes, edges) {\n  const menubar = d3.select('#menubar')\n      .classed('my-1', true);\n  menubar.selectAll('div,span,a').remove();  // Clean up\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n\n  const state = new NetworkState(view, nodes, edges);\n  // TODO: define field size according to the data size\n  state.fieldWidth = 1200;\n  state.fieldHeight = 1200;\n\n  // Network view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, 'Menu', 'primary', 'network-white')\n      .select('.dropdown-menu');\n  menu.append('a').call(communityDialog.menuLink);\n  menu.append('a').call(renameDialog.menuLink);\n  menu.append('a')\n      .call(button.dropdownMenuItem, 'Save', 'menu-save')\n      .on('click', function () {\n        return state.save()\n          .then(() => menubar.select('.notify-saved').call(badge.notify));\n      });\n\n  // Dashboard link\n  menubar.append('a')\n      .call(button.menuButtonLink, 'Dashboard',\n            'outline-secondary', 'status-gray')\n      .attr('href', 'dashboard.html')\n      .attr('target', '_blank');\n\n  // Fetch control\n  menubar.append('a')\n      .classed('refresh', true)\n      .call(button.menuButtonLink,\n            'Refresh', 'outline-secondary', 'refresh-gray')\n      .on('click', function () {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        return state.edges.pull().then(() => {\n          state.updateAllNotifier();\n          return updateApp(state);\n        });\n      });\n  menubar.append('a')\n      .classed('abort', true)\n      .call(button.menuButtonLink,\n            'Abort server job', 'warning', 'delete-gray')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', '#abort-dialog');\n\n  // Status\n  menubar.append('span')\n      .classed('loading-circle', true)\n      .call(badge.loadingCircle);\n  menubar.append('span')\n      .classed('notify-saved', true)\n      .call(badge.alert)\n      .call(badge.updateAlert, 'State saved', 'success', 'check-green')\n      .style('display', 'none');\n  menubar.append('span')\n      .classed('name', true);\n  menubar.append('span')\n      .classed('nodes-count', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('edges-count', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('fetch-status', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('exec-time', true)\n      .call(badge.badge);\n\n  // Dialogs\n  dialogs.append('div')\n      .classed('communityd', true)\n      .call(communityDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body);\n  dialogs.append('div')\n      .classed('abortd', true)\n      .call(modal.confirmDialog, 'abort-dialog');\n\n  // Contents\n  const frame = d3.select('#nw-frame')\n      .call(transform.viewFrame, state);\n  frame.select('.view')\n      .call(component.networkView, state)\n      .call(force.activate, state)\n      .call(interaction.setInteraction, state);\n  d3.select('#nw-control')\n      .call(control.controlBox, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#nw-frame').call(transform.resize, state);\n\n  // Update\n  state.updateAllNotifier();\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  // Title\n  d3.select('title').text(state.name);\n\n  // hide fetch commands\n  d3.select('#menubar').selectAll('.refresh, .abort')\n    .style('display', state.edges.ongoing() ? null : 'none');\n\n  // Status\n  d3.select('#menubar .name').text(state.name);\n\n  const onLoading = d3.select('#menubar .loading-circle');\n  const colors = {\n    done: 'green', running: 'darkorange',\n    ready: 'cornflowerblue', queued: 'cornflowerblue',\n    interrupted: 'salmon', aborted: 'salmon', failure: 'salmon'\n  };\n  const icons = {\n    done: 'check-green', running: 'running-darkorange',\n    ready: 'clock-cornflowerblue', queued: 'clock-cornflowerblue',\n    interrupted: 'caution-salmon', aborted: 'caution-salmon',\n    failure: 'caution-salmon'\n  };\n  const fstatus = state.edges.status();\n  const fstext = fstatus === 'done' ?\n    fstatus : `${fstatus} ${state.edges.progress()}%`;\n  const commaf = d3.format(',');\n  const timef = d3.format(',.4g');\n  d3.select('#menubar .nodes-count')\n      .call(badge.updateBadge, `${commaf(state.nodes.size())} nodes`,\n            'light', 'nodes-gray')\n    .select('.text')\n      .style('color', 'gray');\n  d3.select('#menubar .edges-count')\n      .call(badge.updateBadge, `${commaf(state.edges.size())} edges`,\n            'light', 'edges-gray')\n    .select('.text')\n      .style('color', 'gray');\n  d3.select('#menubar .fetch-status')\n      .call(badge.updateBadge, fstext, 'light', icons[fstatus])\n    .select('.text')\n      .style('color', colors[fstatus]);\n  d3.select('#menubar .exec-time')\n      .call(badge.updateBadge, `${timef(state.edges.execTime())} seconds`,\n            'light', 'clock-cornflowerblue')\n    .select('.text')\n      .style('color', 'cornflowerblue');\n\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n\n  // Community detection dialog\n  dialogs.select('.communityd')\n      .call(communityDialog.updateBody, state.nodes.fields)\n      .on('submit', function () {\n        onLoading.style('display', 'inline-block');\n        const value = communityDialog.value(d3.select(this));\n        const ns = state.nodes.records();\n        const es = state.currentEdges();\n        const ops = {\n          nodeField: 'index',\n          weightField: state.connThldField,\n          nulliso: value.nulliso\n        };\n        const comm = community.communityDetection(ns, es, ops);\n        const mapping = {\n          key: 'index',\n          field: {key: value.name, name: value.name,\n                  format: 'd3_format', d3_format: 'd'},\n          mapping: comm\n        };\n        state.nodes.joinFields(mapping);\n        const catKeys = state.nodes.records().map(e => e[value.name]);\n        state.nodeColor = {\n          field: value.name, color: 'category40',\n          scale: 'ordinal', domain: _.uniq(catKeys).sort(),\n          range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n        };\n        state.updateAllNotifier();\n        updateApp(state);\n      });\n\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state.name)\n      .on('submit', function () {\n        onLoading.style('display', 'inline-block');\n        state.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n      });\n\n  // Abort dialog\n  dialogs.select('.abortd')\n      .call(modal.updateConfirmDialog,\n            'Are you sure you want to abort this calculation job?')\n      .on('submit', function () {\n        onLoading.style('display', 'inline-block');\n        return state.edges.abort().then(() => {\n          state.updateAllNotifier();\n          updateApp(state);\n        });\n      });\n\n  onLoading.style('display', 'none');\n}\n\n\nfunction run() {\n  const err = client.compatibility();\n  if (err) {\n    d3.select('body')\n      .style('color', '#ff0000')\n      .text(err);\n    return;\n  }\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  client.registerServiceWorker();\n  const instance = client.URLQuery().instance || null;\n  const viewID = client.URLQuery().view || null;\n  return idb.getView(instance, viewID)\n    .then(view => {\n      if (!view) throw('ERROR: invalid URL');\n      view.instance = instance;\n      return Promise.all([\n        idb.getCollection(instance, view.nodes),\n        idb.getCollection(instance, view.edges)\n      ])\n      .then(colls => {\n        colls[0].instance = instance;\n        colls[1].instance = instance;\n        app(view, colls[0], colls[1]);\n      });\n    })\n    .catch(err => {\n      console.error(err);\n      d3.select('#nw-frame')\n        .style('color', 'red')\n        .text(err);\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["URLQuery","pairs","window","location","search","substring","split","map","e","_","fromPairs","compatibility","indexedDB","registerServiceWorker","navigator","isDebugBuild","console","info","addEventListener","serviceWorker","register","registerCtrlCommand","key","callback","document","event","ctrlKey","sortType","fmt","includes","formatNum","value","d3format","undefined","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","specs","now","Date","isNW","v08_nodes","width","height","convertTable","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","edgeColor","color","edgeLabelColor","connect","version","createObj","Promise","resolve","reject","request","open","onsuccess","this","result","onerror","onupgradeneeded","currentTarget","instance","pkgs","db","createObjectStore","keyPath","assets","clear","dbid","then","req","transaction","objectStore","getAllItems","res","openCursor","cursor","continue","getItem","get","putItem","put","updateItem","updater","obj","upd","clearAll","all","deleteItem","delete","getView","pkg","appendView","viewObj","item","pos","findIndex","splice","updateView","isFunction","deleteView","bin","Object","entries","entry","getAllCollections","items","flatten","coll","getCollection","collID","addCollection","collObj","updateCollection","importItem","legacy","misc","slice","sessionStarted","newDatagrid","response","toLocaleString","timeZone","addDatagrid","add384Tiles","rowCount","columnCount","chunksPerRow","newNetwork","nodesName","edgesID","getAsset","putAsset","content","assetBaseURL","iconBaseURL","badge","selection","classed","append","style","updateBadge","icon","select","attr","notify","transition","duration","ease","easeLinear","delay","on","loadingCircle","alert","updateAlert","invalidFeedback","updateInvalidMessage","msg","buttonBox","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","node","click","dropdownMenuFileValue","files","dialogBase","confirmDialog","base","call","footer","dispatch","updateConfirmDialog","message","submitDialog","title","header","html","$","modal","colorScales","colors","schemePaired","concat","schemeSet2","schemePastel2","schemeSet3","types","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","scaleFunction","state","cscale","length","mid","scaleFunc","clamp","d","isD3Format","notation","err","monocolorBar","group","colorBar","monocolor","bicolor","grad","tricolor","categorical","sw","custom","setSize","colorBarLegend","domains","updateColorBarLegend","colorState","shape","selectAll","remove","updateLegendGroup","viewBox","orient","scaleF","right","o","viewW","viewH","bottom","legW","legH","posX","left","posY","top","resize","area","offsetWidth","offsetHeight","setViewBox","resizeNotifier","transform","tx","ty","tk","viewFrame","formValue","property","formValid","checkValidity","setValidity","valid","textareaValid","test","fileInputBox","fileInputValid","updateFormValue","textBox","readonlyBox","updateReadonlyValue","readonlyValue","textareaBox","placeholder","textareaBoxLines","numberBox","updateNumberRange","min","max","step","bubbles","checkBox","box","updateCheckBox","checked","checkBoxValue","colorBox","stopPropagation","clearFileInput","fileInputValue","menuLink","body","mbody","updateBody","noDup","invmsg","nulliso","renameBox","baseURL","url","q","keys","JSON","stringify","fetch","credentials","Error","statusText","blob","post","formdata","method","error","serverStatus","server","schema","batchRequest","reqs","interval","ress","setTimeout","singleToMulti","mapping","newMapping","m","mappingToTable","mp","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","autoIndex","addField","fs","mapper","command","fetcher","idb","sum","some","TransformState","fieldWidth","fieldHeight","focusArea","focusAreaMargin","boundary","x","y","prevTransform","margin","setFocusArea","vh","vw","vr","bh","bw","isPortrait","adjustH","adjustV","setTransform","NetworkState","super","focusedViewThreshold","enableFocusedView","focusedView","overlookViewThreshold","enableOverlookView","overlookView","legendOrient","legend","assign","connThldField","forceActive","forceType","zoomListener","dragListener","updateAllNotifier","updateComponentNotifier","updateNodeNotifier","updateEdgeNotifier","updateNodeAttrNotifier","updateEdgeAttrNotifier","updateLegendNotifier","updateControlBoxNotifier","updateInteractionNotifier","fitNotifier","setForceNotifier","stickNotifier","relaxNotifier","restartNotifier","tickCallback","ns","es","parse","n","adjacency","num","setAllCoords","xs","ys","coordsList","nbr","sx","sy","setBoundary","currentEdges","ni","export","ei","vi","communityDetection","option","nodeField","weightField","community","weight","clusters","jLouvain","a","b","cluster","checklistValues","anyChecked","setChecklistValidity","setSelectedColorScale","selected","datum","selectBox","updateSelectBoxOptions","options","exit","enter","selectedRecord","checklistBox","updateChecklistItems","listitems","form","checkRequired","updateChecklistValues","each","colorScaleBox","dropdown","colorScaleBoxItems","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","linearValid","stepm","validity","stepMismatch","linearRangeValid","minValid","maxValid","logValid","logRangeValid","minPos","maxPos","rangeBox","minBox","maxBox","linearRange","logRange","updateRangeValues","rangeValues","colorRangeBox","midBox","updateColorRangeValues","colorRangeValues","dropdownFormGroup","colorRangeGroup","lbox","collapse","rbox","updateColorRangeGroup","customRange","cs","rg","customScale","rtype","rboxValues","colorGroupValues","colorScale","colorScaleType","scaleBoxGroup","isLog","updateScaleBoxGroup","scaleGroupValues","scaleBoxGroupValid","dm","colorControlBox","fieldName","noScale","updateColorControl","fieldOptions","colorControlValid","colorControlState","sizeControlBox","updateSizeControl","sizeState","sizeControlValid","rangeValid","unkValid","scaleValid","sizeControlState","labelControlBox","labelGroup","updateLabelControl","labelState","labelControlValid","labelControlState","labelColor","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","explorativeNetwork","baseFactor","expnet","elevations","pathWeights","mn","bf","svgWidth","svgHeight","updateNodes","showStruct","entered","updateNodeCoords","merged","merge","updateEdges","updateEdgeCoords","updateNodeAttrs","colorConv","sizeConv","labelColorConv","htwidth","fo","d3_format","textConv","updateEdgeAttrs","widthConv","updateAttrs","updateComponents","nodesToRender","numNodes","edgesToRender","moveNode","moveEdge","move","networkView","legendGroup","updateWorkingCopy","expn","elevmap","joinFields","pathmap","pweight","drag","component","setCoords","zoom","t","p","xMoved","yMoved","zoomIn","selectListener","sel","preventDefault","isSel","resume","tf","zoomIdentity","translate","nodesSelected","nodesNotSelected","partition","edgesSelected","edgesNotSelected","setInteraction","selectedObj","shiftKey","rect","origin","initSel","abs","xConv","yConv","parentNode","adj","rectSelectListener","multiSelectListener","dx","dy","newX","newY","multiDragListener","fitTransform","force","forceSimulation","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceX","forceY","forceCenter","stop","stick","simulation","alpha","fx","fy","interaction","unstick","active","alphaTarget","forceDragListener","activate","links","restart","mainControlBox","viewModes","thldGroup","forceBox","updateMainControl","thldFields","thld","numEdges","combinations","logD","log10","isStopped","alphaMin","parseInt","updateNodeColorControl","cbox","uniq","updateEdgeColorControl","updateNodeSizeControl","updateEdgeWidthControl","updateNodeLabelControl","updateEdgeLabelControl","updateControlBox","controlBox","tabs","updateApp","ongoing","onLoading","fstatus","fstext","commaf","timef","done","running","ready","queued","interrupted","aborted","failure","dialogs","communityDialog","ops","comm","catKeys","renameDialog","abort","run","client","protocol","onLine","colls","menubar","menu","save","pull","control","onresize","app","catch"],"mappings":"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"}